import streamlit as st
import os
from groq import Groq
from dotenv import load_dotenv
import json
import requests
import pandas as pd
import random
import time
from datetime import datetime, timedelta
import plotly.express as px
import plotly.graph_objects as go
from geopy.geocoders import Nominatim
import folium
from streamlit_folium import folium_static

# Cargar variables de entorno
load_dotenv()

# Inicializar cliente Groq
api_key = os.environ.get("GROQ_API_KEY")
if not api_key:
    st.error("‚ùå GROQ_API_KEY no encontrado en el archivo .env.")
    st.stop()
client = Groq(api_key=api_key)

# Claves API
PEXELS_API_KEY = os.environ.get("PEXELS_API_KEY", "")
UNSPLASH_ACCESS_KEY = os.environ.get("UNSPLASH_ACCESS_KEY", "")
GOOGLE_PLACES_API_KEY = os.environ.get("GOOGLE_PLACES_API_KEY", "")
OPENTRIPMAP_API_KEY = os.environ.get("OPENTRIPMAP_API_KEY", "")
FOURSQUARE_API_KEY = os.environ.get("FOURSQUARE_API_KEY", "")

# Configuraci√≥n de p√°gina
st.set_page_config(
    page_title="üåç Asistente de Itinerario de Viaje IA",
    page_icon="üá±üá∞",
    layout="wide",
    initial_sidebar_state="expanded"
)

# CSS mejorado con Tema Blanco
st.markdown("""
<style>
    /* Contenedor principal - Tema Blanco */
    .stApp {
        background: #ffffff;
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    }
    
    /* Fondo del contenido principal */
    .main .block-container {
        background: #ffffff;
    }
    
    /* Encabezado de la aplicaci√≥n con transparencia y vista de tarjeta */
.header-card {
    background: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    border-radius: 24px;
    padding: 40px;
    margin: 20px auto;
    max-width: 1200px;
    box-shadow: 
        0 20px 60px rgba(0, 0, 0, 0.08),
        0 8px 32px rgba(59, 130, 246, 0.05),
        inset 0 1px 0 rgba(255, 255, 255, 0.6);
    position: relative;
    overflow: hidden;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.header-card:hover {
    transform: translateY(-4px);
    box-shadow: 
        0 30px 80px rgba(0, 0, 0, 0.12),
        0 15px 40px rgba(59, 130, 246, 0.08),
        inset 0 1px 0 rgba(255, 255, 255, 0.8);
    background: rgba(255, 255, 255, 0.92);
}

.header-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);
    border-radius: 24px 24px 0 0;
    z-index: 1;
}

.header-card::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 150%;
    height: 150%;
    background: radial-gradient(circle at center, 
        rgba(59, 130, 246, 0.05) 0%,
        rgba(139, 92, 246, 0.03) 25%,
        rgba(236, 72, 153, 0.01) 50%,
        transparent 70%);
    transform: translate(-50%, -50%);
    z-index: 0;
    pointer-events: none;
}

.header-content {
    position: relative;
    z-index: 2;
    text-align: center;
}

.glow-effect {
    position: absolute;
    top: -50%;
    left: -50%;
    right: -50%;
    bottom: -50%;
    background: radial-gradient(circle at center, 
        rgba(59, 130, 246, 0.08) 0%,
        rgba(139, 92, 246, 0.04) 30%,
        transparent 70%);
    animation: gentlePulse 8s ease-in-out infinite;
    pointer-events: none;
    z-index: 1;
}

@keyframes gentlePulse {
    0%, 100% { opacity: 0.3; transform: scale(1); }
    50% { opacity: 0.5; transform: scale(1.02); }
}

.gradient-text {
    background: linear-gradient(135deg, 
        #1e40af 0%,
        #3b82f6 25%,
        #8b5cf6 50%,
        #ec4899 75%,
        #f59e0b 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    text-fill-color: transparent;
    background-size: 200% auto;
    animation: gradientShift 8s ease-in-out infinite;
    font-weight: 800;
    letter-spacing: -0.5px;
}

@keyframes gradientShift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

.header-subtitle {
    color: #475569;
    font-size: 1.2rem;
    line-height: 1.6;
    max-width: 800px;
    margin: 0 auto;
    padding: 0 20px;
    position: relative;
}

.header-subtitle::before,
.header-subtitle::after {
    content: '‚ú¶';
    position: absolute;
    color: #3b82f6;
    font-size: 1.5rem;
    opacity: 0.6;
    animation: subtleFloat 4s ease-in-out infinite;
}

.header-subtitle::before {
    left: -10px;
    top: 50%;
    transform: translateY(-50%);
    animation-delay: 0s;
}

.header-subtitle::after {
    right: -10px;
    top: 50%;
    transform: translateY(-50%);
    animation-delay: 2s;
}

@keyframes subtleFloat {
    0%, 100% { transform: translateY(-50%) rotate(0deg); opacity: 0.4; }
    50% { transform: translateY(-55%) rotate(180deg); opacity: 0.8; }
}

.header-icons {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 25px;
    flex-wrap: wrap;
}

.header-icon {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 16px;
    background: rgba(59, 130, 246, 0.08);
    border: 1px solid rgba(59, 130, 246, 0.15);
    border-radius: 12px;
    color: #1e40af;
    font-size: 0.9rem;
    font-weight: 500;
    backdrop-filter: blur(10px);
    transition: all 0.3s ease;
}

.header-icon:hover {
    background: rgba(59, 130, 246, 0.15);
    border-color: rgba(59, 130, 246, 0.3);
    transform: translateY(-2px);
}

/* Ajustes responsivos */
@media (max-width: 768px) {
    .header-card {
        padding: 30px 20px;
        margin: 10px;
        border-radius: 20px;
    }
    
    .gradient-text {
        font-size: 2.5rem;
    }
    
    .header-subtitle {
        font-size: 1.1rem;
        padding: 0 10px;
    }
    
    .header-icons {
        gap: 10px;
    }
    
    .header-icon {
        padding: 6px 12px;
        font-size: 0.85rem;
    }
}

@media (max-width: 480px) {
    .header-card {
        padding: 25px 15px;
        border-radius: 16px;
    }
    
    .gradient-text {
        font-size: 2rem;
    }
    
    .header-subtitle {
        font-size: 1rem;
    }
    
    .header-icons {
        flex-direction: column;
        align-items: center;
    }
    
    .header-icon {
        width: 100%;
        max-width: 200px;
        justify-content: center;
    }
}

/* Efectos especiales al pasar el cursor */
.header-card:hover .gradient-text {
    animation-duration: 4s;
}

.header-card:hover .header-subtitle::before,
.header-card:hover .header-subtitle::after {
    animation-duration: 2s;
}

/* Mejoras del modo claro */
.light-theme .header-card {
    background: rgba(255, 255, 255, 0.92);
    border: 1px solid rgba(0, 0, 0, 0.08);
}

.light-theme .header-icon {
    background: rgba(59, 130, 246, 0.1);
    border: 1px solid rgba(59, 130, 246, 0.2);
    color: #1e40af;
}

/* Soporte del modo oscuro (si es necesario) */
.dark-theme .header-card {
    background: rgba(15, 23, 42, 0.8);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.dark-theme .header-subtitle {
    color: #94a3b8;
}

.dark-theme .header-icon {
    background: rgba(59, 130, 246, 0.15);
    border: 1px solid rgba(59, 130, 246, 0.3);
    color: #60a5fa;
}
                   
    /* ===============================
   BARRA LATERAL (VIDRIO LUMINOSO)
================================ */
section[data-testid="stSidebar"] {
    background: rgba(255,255,255,0.75) !important;
    backdrop-filter: blur(14px);
    border-right: 1px solid rgba(0,0,0,0.08);
}
    
    /* Estilo de tarjeta mejorado - Tema Blanco */
    .place-card {
        background: #ffffff;
        backdrop-filter: blur(10px);
        border: 1px solid #e2e8f0;
        border-radius: 20px;
        padding: 25px;
        margin: 20px 0;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
        height: 100%;
        position: relative;
        overflow: hidden;
    }
    
    .place-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #3b82f6, #8b5cf6);
        border-radius: 20px 20px 0 0;
    }
    
    .place-card:hover {
        transform: translateY(-8px) scale(1.02);
        border-color: #3b82f6;
        box-shadow: 0 20px 60px rgba(59, 130, 246, 0.15);
    }
    
    /* Contenedor de imagen */
    .image-container {
        width: 100%;
        height: 220px;
        border-radius: 16px;
        overflow: hidden;
        margin-bottom: 20px;
        border: 2px solid #e2e8f0;
        position: relative;
    }
    
    .image-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.6s ease;
    }
    
    .image-container:hover img {
        transform: scale(1.15);
    }
    
    .image-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
        padding: 15px;
        color: white;
        font-size: 0.8rem;
    }
    
    /* Estilo de insignia */
    .place-badge {
        display: inline-block;
        padding: 8px 16px;
        border-radius: 25px;
        font-size: 0.8rem;
        font-weight: 600;
        margin-bottom: 15px;
        background: rgba(59, 130, 246, 0.1);
        color: #1e40af;
        border: 1px solid rgba(59, 130, 246, 0.2);
        backdrop-filter: blur(5px);
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }
    
    /* Estrellas de calificaci√≥n */
    .rating-container {
        display: flex;
        align-items: center;
        gap: 8px;
        margin: 15px 0;
    }
    
    .stars {
        color: #f59e0b;
        font-size: 1rem;
        text-shadow: 0 0 10px rgba(245, 158, 11, 0.2);
    }
    
    /* Informaci√≥n de tiempo */
    .time-info {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid #e2e8f0;
    }
    
    .time-item {
        display: flex;
        align-items: center;
        gap: 8px;
        color: #475569;
        font-size: 0.85rem;
        background: #f8fafc;
        padding: 8px 12px;
        border-radius: 12px;
    }
    
    /* Encabezado de d√≠a */
    .day-header {
        background: linear-gradient(135deg, #3b82f6, #8b5cf6);
        padding: 20px 30px;
        border-radius: 20px;
        margin: 25px 0;
        border: 1px solid rgba(59, 130, 246, 0.3);
        position: relative;
        overflow: hidden;
    }
    
    .day-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none" opacity="0.1"><path d="M0,0 L100,0 L100,100 Z" fill="white"/></svg>');
        background-size: cover;
    }
    
    /* Encabezados de secci√≥n */
    .section-title {
        color: #1e293b;
        font-size: 2rem;
        font-weight: 800;
        margin: 40px 0 25px 0;
        padding-bottom: 15px;
        border-bottom: 3px solid #3b82f6;
        position: relative;
        display: inline-block;
    }
    
    .section-title::after {
        content: '';
        position: absolute;
        bottom: -3px;
        left: 0;
        width: 60px;
        height: 3px;
        background: linear-gradient(90deg, #3b82f6, #8b5cf6);
        border-radius: 3px;
    }
    
    /* Tarjetas de estad√≠sticas */
    .stat-card {
        background: #ffffff;
        border-radius: 20px;
        padding: 25px;
        text-align: center;
        border: 1px solid #e2e8f0;
        transition: all 0.3s ease;
        backdrop-filter: blur(5px);
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
    }
    
    .stat-card:hover {
        transform: translateY(-5px);
        border-color: #3b82f6;
        box-shadow: 0 10px 30px rgba(59, 130, 246, 0.1);
    }
    
    .stat-icon {
        font-size: 2.5rem;
        margin-bottom: 15px;
        display: inline-block;
    }
    
    .stat-number {
        font-size: 2.5rem;
        font-weight: 800;
        color: #1e40af;
        margin: 10px 0;
        background: linear-gradient(90deg, #1e40af, #7c3aed);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    .stat-label {
        color: #475569;
        font-size: 0.9rem;
        font-weight: 500;
        letter-spacing: 0.5px;
    }
    
    /* Tarjetas de horario */
    .schedule-card {
        background: #ffffff;
        border-radius: 20px;
        padding: 25px;
        border-left: 5px solid;
        margin: 15px 0;
        backdrop-filter: blur(5px);
        transition: all 0.3s ease;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
    }
    
    .schedule-card:hover {
        transform: translateX(5px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }
    
    .morning-card {
        border-left-color: #f59e0b;
        background: linear-gradient(to right, #fff7ed, #ffffff);
    }
    
    .afternoon-card {
        border-left-color: #10b981;
        background: linear-gradient(to right, #f0fdf4, #ffffff);
    }
    
    .evening-card {
        border-left-color: #8b5cf6;
        background: linear-gradient(to right, #faf5ff, #ffffff);
    }
    
    /* Estilo de botones */
    .stButton > button {
        border-radius: 12px;
        padding: 12px 24px;
        font-weight: 600;
        transition: all 0.3s ease;
        border: none;
        background: linear-gradient(135deg, #3b82f6, #8b5cf6);
        color: white;
    }
    
    .stButton > button:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
    }
    
    /* Barra de desplazamiento personalizada */
    ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
    }
    
    ::-webkit-scrollbar-track {
        background: #f1f5f9;
        border-radius: 10px;
    }
    
    ::-webkit-scrollbar-thumb {
        background: linear-gradient(135deg, #3b82f6, #8b5cf6);
        border-radius: 10px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(135deg, #2563eb, #7c3aed);
    }
    
    /* Texto degradado */
    .gradient-text {
        background: linear-gradient(90deg, #1e40af, #7c3aed, #be185d);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-weight: 800;
    }
    
    /* Estilo de etiquetas */
    .place-tag {
        display: inline-block;
        padding: 4px 12px;
        border-radius: 15px;
        font-size: 0.75rem;
        background: #f1f5f9;
        color: #475569;
        margin: 3px;
        border: 1px solid #e2e8f0;
    }
    
    /* Contenedor de mapa */
    .map-container {
        border-radius: 20px;
        overflow: hidden;
        border: 2px solid #e2e8f0;
        margin: 20px 0;
    }
    
    /* Animaci√≥n de carga */
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
    }
    
    .loading {
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }
    
    /* Colores de texto para el tema blanco */
    h1, h2, h3, h4, h5, h6 {
        color: #1e293b !important;
    }
    
    p, span, div {
        color: #334155 !important;
    }
    
    /* Mejoras de la barra lateral */
    .css-1d391kg {
        border-right: 1px solid #e2e8f0;
    }
    
    /* Campos de entrada */
    .stTextInput > div > div > input,
    .stTextArea > div > div > textarea,
    .stSelectbox > div > div > select {
        background: #ffffff;
        border: 1px solid #e2e8f0;
        color: #1e293b;
    }
    
    /* Casillas de verificaci√≥n y selecci√≥n */
    .stCheckbox > label,
    .stSelectbox > label {
        color: #334155;
    }
    
    /* Cajas Markdown */
    .stMarkdown {
        color: #334155;
    }
    
    /* Cajas de informaci√≥n, √©xito, advertencia, error */
    .stAlert {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
    }
    
    /* Estilo de pesta√±as */
    .stTabs [data-baseweb="tab-list"] {
        background: #f8fafc;
        border-radius: 12px;
        padding: 8px;
    }
    
    .stTabs [data-baseweb="tab"] {
        border-radius: 8px;
        padding: 10px 20px;
    }
    
    /* Divisor */
    hr {
        border-color: #e2e8f0;
    }
    
    /* Informaci√≥n sobre herramientas */
    .stTooltip {
        background: #ffffff;
        border: 1px solid #e2e8f0;
        color: #334155;
    }
    
    /* Contenedores de m√©tricas */
    .stMetric {
        background: #ffffff;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        padding: 20px;
    }
    
    /* Barra de progreso */
    .stProgress > div > div > div {
        background: linear-gradient(90deg, #3b82f6, #8b5cf6);
    }
    
    /* Editor de datos */
    .stDataFrame {
        border: 1px solid #e2e8f0;
        border-radius: 12px;
        overflow: hidden;
    }
    
    /* Mensajes de chat */
    .stChatMessage {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 12px;
    }
    
    /* Expansor */
    .streamlit-expanderHeader {
        background: #f8fafc;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
    }
</style>
""", unsafe_allow_html=True)

# Inicializar estado de sesi√≥n
if 'itinerary' not in st.session_state:
    st.session_state.itinerary = None
if 'email_text' not in st.session_state:
    st.session_state.email_text = ""
if 'image_cache' not in st.session_state:
    st.session_state.image_cache = {}
if 'places_cache' not in st.session_state:
    st.session_state.places_cache = {}
if 'countries_data' not in st.session_state:
    st.session_state.countries_data = {}

# Funci√≥n para obtener todos los pa√≠ses de la API REST Countries
@st.cache_data(ttl=86400) # Cache por 24 horas
def get_all_countries():
    """Obtener todos los pa√≠ses con detalles desde la API REST Countries"""
    try:
        response = requests.get("https://restcountries.com/v3.1/all", timeout=10)
        if response.status_code == 200:
            countries = response.json()
            country_list = []
          
            for country in countries:
                country_data = {
                    "name": country.get("name", {}).get("common", "Desconocido"),
                    "official_name": country.get("name", {}).get("official", ""),
                    "capital": country.get("capital", ["N/A"])[0] if country.get("capital") else "N/A",
                    "region": country.get("region", "N/A"),
                    "subregion": country.get("subregion", "N/A"),
                    "population": country.get("population", 0),
                    "area": country.get("area", 0),
                    "languages": list(country.get("languages", {}).values()) if country.get("languages") else [],
                    "currencies": list(country.get("currencies", {}).keys()) if country.get("currencies") else [],
                    "flag": country.get("flag", "üè≥Ô∏è"),
                    "timezones": country.get("timezones", []),
                    "borders": country.get("borders", []),
                    "cca2": country.get("cca2", ""), # C√≥digo de pa√≠s
                    "latlng": country.get("latlng", [0, 0]) # Latitud, Longitud
                }
                country_list.append(country_data)
          
            # Ordenar alfab√©ticamente
            country_list.sort(key=lambda x: x["name"])
            return country_list
    except Exception as e:
        st.warning(f"No se pudieron obtener los pa√≠ses: {str(e)}")
        return []
  
    return []

# Funci√≥n para obtener lugares reales desde la API OpenTripMap
@st.cache_data(ttl=3600)
def get_places_from_opentripmap(lat, lon, radius=10000, limit=20):
    """Obtener atracciones tur√≠sticas desde la API OpenTripMap"""
    if not OPENTRIPMAP_API_KEY:
        return []
  
    try:
        url = "https://api.opentripmap.com/0.1/en/places/radius"
        params = {
            "radius": radius,
            "lon": lon,
            "lat": lat,
            "format": "json",
            "limit": limit,
            "apikey": OPENTRIPMAP_API_KEY,
            "kinds": "historic,architecture,cultural,museums,religion,beaches,natural" # Filtro para atracciones tur√≠sticas
        }
      
        response = requests.get(url, params=params, timeout=10)
        if response.status_code == 200:
            places = response.json()
            detailed_places = []
          
            # Obtener detalles para cada lugar
            for place in places[:10]: # Limitado a 10 por rendimiento
                xid = place.get("xid")
                if xid:
                    details = get_place_details_from_opentripmap(xid)
                    if details:
                        detailed_places.append(details)
          
            return detailed_places
    except Exception as e:
        st.warning(f"Error de API OpenTripMap: {str(e)}")
  
    return []

def get_place_details_from_opentripmap(xid):
    """Obtener informaci√≥n detallada sobre un lugar espec√≠fico"""
    try:
        url = f"https://api.opentripmap.com/0.1/en/places/xid/{xid}"
        params = {"apikey": OPENTRIPMAP_API_KEY}
      
        response = requests.get(url, params=params, timeout=10)
        if response.status_code == 200:
            place = response.json()
          
            # Extraer tipo de lugar de las categor√≠as
            kinds = place.get("kinds", "").split(",")
            place_type = "Atracci√≥n"
            if "historic" in kinds:
                place_type = "Sitio Hist√≥rico"
            elif "museum" in kinds:
                place_type = "Museo"
            elif "religious" in kinds:
                place_type = "Sitio Religioso"
            elif "beach" in kinds:
                place_type = "Playa"
            elif "natural" in kinds:
                place_type = "Natural"
            elif "architecture" in kinds:
                place_type = "Arquitectura"
          
            return {
                "name": place.get("name", "Lugar Desconocido"),
                "type": place_type,
                "description": place.get("wikipedia_extracts", {}).get("text", "Una atracci√≥n tur√≠stica popular.")[:200] + "...",
                "rating": round(random.uniform(3.5, 5.0), 1),
                "coordinates": {
                    "lat": place.get("point", {}).get("lat", 0),
                    "lon": place.get("point", {}).get("lon", 0)
                },
                "wikipedia": place.get("wikipedia", "")
            }
    except:
        pass
  
    return None

# Funci√≥n para obtener lugares desde la API Foursquare
@st.cache_data(ttl=3600)
def get_places_from_foursquare(city, country, category="tourism"):
    """Obtener lugares desde la API Foursquare"""
    if not FOURSQUARE_API_KEY:
        return []
  
    try:
        url = "https://api.foursquare.com/v3/places/search"
        headers = {
            "Authorization": FOURSQUARE_API_KEY,
            "accept": "application/json"
        }
      
        query = f"{city}, {country}"
        params = {
            "query": "tourist attraction",
            "near": query,
            "limit": 15,
            "categories": "16000" # Categor√≠a Viajes y Transporte
        }
      
        response = requests.get(url, headers=headers, params=params, timeout=10)
        if response.status_code == 200:
            data = response.json()
            places = []
          
            for venue in data.get("results", []):
                place = {
                    "name": venue.get("name", "Desconocido"),
                    "type": venue.get("categories", [{}])[0].get("name", "Atracci√≥n"),
                    "rating": venue.get("rating", round(random.uniform(3.5, 5.0), 1)),
                    "description": f"Una atracci√≥n popular en {city}.",
                    "coordinates": {
                        "lat": venue.get("geocodes", {}).get("main", {}).get("latitude", 0),
                        "lon": venue.get("geocodes", {}).get("main", {}).get("longitude", 0)
                    }
                }
                places.append(place)
          
            return places
    except Exception as e:
        st.warning(f"Error de API Foursquare: {str(e)}")
  
    return []

# Funci√≥n para obtener coordenadas de una ciudad
@st.cache_data(ttl=86400)
def get_city_coordinates(city, country):
    """Obtener latitud y longitud de una ciudad"""
    try:
        geolocator = Nominatim(user_agent="travel_itinerary_app")
        location = geolocator.geocode(f"{city}, {country}")
        if location:
            return location.latitude, location.longitude
    except:
        pass
  
    # Coordenadas de respaldo para ciudades de Sri Lanka
    fallback_coords = {
        "Colombo": (6.9271, 79.8612),
        "Kandy": (7.2906, 80.6337),
        "Galle": (6.0535, 80.2200),
        "Negombo": (7.2090, 79.8367),
        "Bentota": (6.4210, 79.9988),
        "Hikkaduwa": (6.1390, 80.1038),
        "Mirissa": (5.9455, 80.4583),
        "Weligama": (5.9743, 80.4294),
        "Tangalle": (6.0167, 80.7833),
        "Nuwara Eliya": (6.9497, 80.7890),
        "Ella": (6.8675, 81.0486),
        "Badulla": (6.9895, 81.0557),
        "Bandarawela": (6.8256, 80.9982),
        "Hatton": (6.8917, 80.5958),
        "Sigiriya": (7.9570, 80.7603),
        "Dambulla": (7.8567, 80.6491),
        "Polonnaruwa": (7.9403, 81.0188),
        "Anuradhapura": (8.3114, 80.4037),
        "Trincomalee": (8.5874, 81.2152),
        "Batticaloa": (7.7167, 81.7000),
        "Pasikudah": (7.9347, 81.5677),
        "Arugam Bay": (6.8385, 81.8352),
        "Jaffna": (9.6615, 80.0255),
        "Mannar": (8.9814, 79.9044),
        "Vavuniya": (8.7543, 80.4981),
        "Yala": (6.3833, 81.5167),
        "Udawalawe": (6.4435, 80.8747),
        "Wilpattu": (8.4500, 80.0000),
        "Kitulgala": (6.9894, 80.4175),
        "Ratnapura": (6.6828, 80.3992),
        "Kalutara": (6.5831, 79.9593),
        "Beruwala": (6.4733, 79.9844),
        "Chilaw": (7.5758, 79.7956),
        "Puttalam": (8.0362, 79.8283),
        "Matara": (5.9485, 80.5353),
        "Hambantota": (6.1240, 81.1185),
        "Ampara": (7.2833, 81.6667),
        "Monaragala": (6.8728, 81.3506),
        "Kurunegala": (7.4867, 80.3647),
        "Kegalle": (7.2533, 80.3464),
        "Matale": (7.4675, 80.6234),
        "Nuwara Eliya": (6.9708, 80.7829)
    }
  
    if city in fallback_coords:
        return fallback_coords[city]
  
    # Devolver coordenadas predeterminadas
    return (7.8731, 80.7718) # Centro de Sri Lanka

# Funci√≥n para obtener im√°genes reales con m√∫ltiples fuentes
@st.cache_data(ttl=3600, show_spinner=False)
def get_place_image(place_name, city, country, size="medium"):
    """Obtener im√°genes de alta calidad para un lugar real desde m√∫ltiples fuentes"""
    cache_key = f"{place_name}_{city}_{country}_{size}"
  
    # Verificar primero la cach√©
    if cache_key in st.session_state.image_cache:
        return st.session_state.image_cache[cache_key]
  
    # Intentar primero con Unsplash
    if UNSPLASH_ACCESS_KEY:
        try:
            url = "https://api.unsplash.com/search/photos"
            headers = {"Authorization": f"Client-ID {UNSPLASH_ACCESS_KEY}"}
          
            queries = [
                f"{place_name} {city} {country} turismo",
                f"{place_name} monumento",
                f"{city} {place_name} atracci√≥n tur√≠stica",
                f"{place_name} viaje",
                place_name
            ]
          
            for query in queries:
                params = {
                    "query": query,
                    "per_page": 1,
                    "orientation": "paisaje",
                    "content_filter": "high"
                }
              
                response = requests.get(url, headers=headers, params=params, timeout=10)
                if response.status_code == 200:
                    data = response.json()
                    if data.get("results") and len(data["results"]) > 0:
                        photo = data["results"][0]
                        image_url = photo["urls"]["regular"] if size == "medium" else photo["urls"]["full"]
                      
                        result = {
                            "url": image_url,
                            "photographer": photo["user"]["name"],
                            "photographer_url": photo["user"]["links"]["html"],
                            "alt": photo.get("alt_description", f"{place_name} en {city}"),
                            "source": "Unsplash"
                        }
                        st.session_state.image_cache[cache_key] = result
                        return result
        except:
            pass
  
    # Intentar con Pexels
    if PEXELS_API_KEY:
        try:
            headers = {"Authorization": PEXELS_API_KEY}
            url = "https://api.pexels.com/v1/search"
          
            queries = [
                f"{place_name} {city} turismo",
                f"{place_name} monumento {country}",
                f"{city} atracciones",
                place_name
            ]
          
            for query in queries:
                params = {
                    "query": query,
                    "per_page": 1,
                    "orientation": "paisaje"
                }
              
                response = requests.get(url, headers=headers, params=params, timeout=10)
                if response.status_code == 200:
                    data = response.json()
                    if data.get("photos") and len(data["photos"]) > 0:
                        photo = data["photos"][0]
                        image_url = photo["src"]["large"] if size == "large" else photo["src"]["medium"]
                      
                        result = {
                            "url": image_url,
                            "photographer": photo["photographer"],
                            "photographer_url": photo["photographer_url"],
                            "alt": photo.get("alt", f"{place_name} en {city}"),
                            "source": "Pexels"
                        }
                        st.session_state.image_cache[cache_key] = result
                        return result
        except:
            pass
  
    # Respuesta: Usar Wikimedia Commons para lugares famosos
    try:
        search_query = f"{place_name} {city}"
        wiki_url = "https://en.wikipedia.org/w/api.php"
        params = {
            "action": "query",
            "format": "json",
            "prop": "pageimages",
            "piprop": "original",
            "titles": search_query
        }
      
        response = requests.get(wiki_url, params=params, timeout=10)
        if response.status_code == 200:
            data = response.json()
            pages = data.get("query", {}).get("pages", {})
            for page in pages.values():
                if "original" in page:
                    result = {
                        "url": page["original"]["source"],
                        "photographer": "Wikimedia Commons",
                        "photographer_url": "https://commons.wikimedia.org",
                        "alt": f"{place_name}",
                        "source": "Wikimedia"
                    }
                    st.session_state.image_cache[cache_key] = result
                    return result
    except:
        pass
  
    # Devolver None si no se encuentra imagen
    return None

# Funci√≥n para obtener lugares reales para una ciudad
def get_real_places(city, country, limit=10):
    """Obtener lugares tur√≠sticos reales para una ciudad desde m√∫ltiples API"""
    cache_key = f"{city}_{country}"
  
    if cache_key in st.session_state.places_cache:
        return st.session_state.places_cache[cache_key]
  
    places = []
  
    # Obtener coordenadas de la ciudad
    lat, lon = get_city_coordinates(city, country)
  
    # Intentar con la API OpenTripMap primero
    opentripmap_places = get_places_from_opentripmap(lat, lon, limit=limit)
    places.extend(opentripmap_places)
  
    # Intentar con la API Foursquare
    foursquare_places = get_places_from_foursquare(city, country)
    places.extend(foursquare_places)
  
    # Si no se encuentran lugares desde las API, usar base de datos de respaldo
    if not places:
        fallback_places = {
"Colombo": [
{"name": "Gangaramaya Temple", "type": "Templo budista", "rating": 4.5, "description": "Un hermoso complejo de templo budista en Colombo con arquitectura tradicional y museo."},
{"name": "Galle Face Green", "type": "Parque urbano", "rating": 4.3, "description": "Parque urbano junto al oc√©ano perfecto para paseos vespertinos, volar cometas y vistas al atardecer."},
{"name": "National Museum of Colombo", "type": "Museo", "rating": 4.2, "description": "El museo m√°s grande de Sri Lanka que muestra el patrimonio cultural y artefactos hist√≥ricos."},
{"name": "Mount Lavinia Beach", "type": "Playa", "rating": 4.2, "description": "√Årea de playa popular con arenas doradas, puntos para nadar y restaurantes junto a la playa."},
{"name": "Viharamahadevi Park", "type": "Parque", "rating": 4.1, "description": "El parque m√°s grande de Colombo con hermosos jardines, fuentes y una gigantesca estatua de Buda."},
{"name": "Independence Memorial Hall", "type": "Monumento", "rating": 4.0, "description": "Monumento hist√≥rico que conmemora la independencia del dominio brit√°nico."},
{"name": "Pettah Floating Market", "type": "Mercado", "rating": 4.0, "description": "Mercado flotante colorido con productos locales, artesan√≠as y comida callejera."},
{"name": "Colombo Dutch Museum", "type": "Museo", "rating": 3.9, "description": "Museo que muestra la historia colonial holandesa en un edificio restaurado del siglo XVII."},
{"name": "Seema Malaka Temple", "type": "Templo budista", "rating": 4.3, "description": "Templo sereno en el lago Beira dise√±ado por Geoffrey Bawa."},
{"name": "Colombo Lotus Tower", "type": "Torre de observaci√≥n", "rating": 4.1, "description": "La torre m√°s alta del sur de Asia con terrazas de observaci√≥n y vistas panor√°micas de la ciudad."}
],
"Kandy": [
{"name": "Temple of the Sacred Tooth Relic", "type": "Templo budista", "rating": 4.8, "description": "Sitio Patrimonio de la Humanidad de la UNESCO que alberga la reliquia del diente de Buda, el sitio budista m√°s sagrado de Sri Lanka."},
{"name": "Kandy Lake", "type": "Lago", "rating": 4.2, "description": "Lago artificial esc√©nico en el coraz√≥n de Kandy, perfecto para paseos vespertinos con vistas al templo."},
{"name": "Royal Botanical Gardens Peradeniya", "type": "Jard√≠n bot√°nico", "rating": 4.6, "description": "Uno de los mejores jardines bot√°nicos de Asia con diversas colecciones de plantas y casa de orqu√≠deas."},
{"name": "Bahiravokanda Vihara Buddha Statue", "type": "Monumento", "rating": 4.4, "description": "Gigantesca estatua de Buda blanca que domina Kandy con vistas panor√°micas de la ciudad."},
{"name": "Udawatta Kele Sanctuary", "type": "Reserva forestal", "rating": 4.3, "description": "Reserva forestal con senderos de senderismo, observaci√≥n de aves y tranquilidad cerca del Templo del Diente."},
{"name": "Kandy Arts & Crafts Association", "type": "Centro de artesan√≠as", "rating": 4.0, "description": "Centro que muestra las artes, artesan√≠as y tallas en madera tradicionales de Sri Lanka."},
{"name": "Commonwealth War Cemetery", "type": "Memorial", "rating": 4.2, "description": "Cementerio bien mantenido que honra a los soldados de la Commonwealth de la Segunda Guerra Mundial."},
{"name": "Kandy View Point", "type": "Punto de vista", "rating": 4.5, "description": "Mejor punto de vista para fotos panor√°micas de la ciudad de Kandy y el lago."},
{"name": "National Museum Kandy", "type": "Museo", "rating": 3.8, "description": "Museo en el antiguo palacio real que muestra la historia y cultura de Kandy."},
{"name": "Embekka Devalaya", "type": "Templo hind√∫", "rating": 4.3, "description": "Famoso por sus intrincadas tallas en madera y pilares, sitio tentativo de la UNESCO."}
],
"Galle": [
{"name": "Galle Fort", "type": "Fortaleza", "rating": 4.8, "description": "Sitio Patrimonio de la Humanidad de la UNESCO con arquitectura colonial holandesa, murallas y calles encantadoras."},
{"name": "Unawatuna Beach", "type": "Playa", "rating": 4.6, "description": "Playa impecable en forma de media luna con arrecifes de coral, deportes acu√°ticos y caf√©s de playa."},
{"name": "Japanese Peace Pagoda", "type": "Pagoda", "rating": 4.3, "description": "Estupa pac√≠fica en la colina Rumassala con vistas panor√°micas al oc√©ano y √°reas de meditaci√≥n."},
{"name": "Galle Lighthouse", "type": "Faro", "rating": 4.4, "description": "Faro ic√≥nico en el borde de la Fortaleza de Galle, la estaci√≥n de luz m√°s antigua de Sri Lanka."},
{"name": "National Maritime Museum", "type": "Museo", "rating": 4.0, "description": "Museo que muestra la historia mar√≠tima, biolog√≠a marina y artefactos navales."},
{"name": "Jungle Beach", "type": "Playa", "rating": 4.5, "description": "Playa aislada rodeada de jungla, accesible por un corto sendero desde Unawatuna."},
{"name": "Galle Fort Clock Tower", "type": "Hito", "rating": 4.2, "description": "Torre del reloj hist√≥rica en la entrada de la fortaleza, construida en 1883."},
{"name": "Martin Wickramasinghe Museum", "type": "Museo", "rating": 4.1, "description": "Museo dedicado al renombrado autor de Sri Lanka en su casa de la infancia."},
{"name": "Rumassala Sanctuary", "type": "Santuario", "rating": 4.3, "description": "Santuario de jungla con senderos de senderismo, plantas medicinales y acceso a la playa."},
{"name": "St. Mary's Cathedral", "type": "Iglesia", "rating": 4.0, "description": "Iglesia cat√≥lica hist√≥rica dentro de la Fortaleza de Galle con hermosa arquitectura."}
],
"Negombo": [
{"name": "Negombo Beach", "type": "Playa", "rating": 4.3, "description": "Larga playa de arena dorada cerca del Aeropuerto Internacional de Colombo, perfecta para paseos al atardecer."},
{"name": "Negombo Fish Market", "type": "Mercado", "rating": 4.2, "description": "Mercado de pescado bullicioso que muestra la captura diaria, subastas y m√©todos de pesca tradicionales."},
{"name": "Dutch Canal", "type": "Canal", "rating": 4.1, "description": "Red hist√≥rica de canales construida por los holandeses, perfecta para paseos en barco y observaci√≥n de aves."},
{"name": "St. Mary's Church", "type": "Iglesia", "rating": 4.3, "description": "Hermosa iglesia cat√≥lica con arquitectura impresionante y significado religioso."},
{"name": "Negombo Lagoon", "type": "Laguna", "rating": 4.4, "description": "Extensa laguna perfecta para observaci√≥n de aves, tours en barco y exploraci√≥n de manglares."},
{"name": "Muthurajawela Marsh", "type": "Humedal", "rating": 4.2, "description": "Humedal protegido con safaris en barco, diversa vida aviar y bosques de manglares."},
{"name": "Angurukaramulla Temple", "type": "Templo budista", "rating": 4.0, "description": "Templo budista antiguo con murales intrincados, estatuas y atm√≥sfera pac√≠fica."},
{"name": "Negombo Dutch Fort", "type": "Fortaleza", "rating": 3.9, "description": "Restos de la fortaleza holandesa que domina la laguna de Negombo, construida en 1672."},
{"name": "Hamilton Canal", "type": "Canal", "rating": 4.0, "description": "Canal esc√©nico construido por los brit√°nicos, que conecta Colombo con Puttalam."},
{"name": "St. Sebastian's Church", "type": "Iglesia", "rating": 4.1, "description": "Iglesia de estilo g√≥tico con hermosas ventanas de vitrales y arquitectura."}
],
"Bentota": [
{"name": "Bentota Beach", "type": "Playa", "rating": 4.5, "description": "Larga playa dorada perfecta para nadar, deportes acu√°ticos y relajaci√≥n con aguas tranquilas."},
{"name": "Brief Garden", "type": "Jard√≠n", "rating": 4.4, "description": "Hermoso jard√≠n creado por Bevis Bawa, hermano del arquitecto Geoffrey Bawa."},
{"name": "Kosgoda Turtle Hatchery", "type": "Centro de conservaci√≥n", "rating": 4.3, "description": "Proyecto de conservaci√≥n y eclosi√≥n de tortugas marinas que protege especies en peligro."},
{"name": "Bentota River Safari", "type": "Crucero fluvial", "rating": 4.4, "description": "Safari en barco a trav√©s de bosques de manglares, v√≠as navegables y puntos de observaci√≥n de aves."},
{"name": "Lunuganga Garden", "type": "Jard√≠n", "rating": 4.6, "description": "Finca campestre y jard√≠n del arquitecto Geoffrey Bawa, que muestra dise√±o paisaj√≠stico."},
{"name": "Galapatha Raja Maha Viharaya", "type": "Templo budista", "rating": 4.2, "description": "Templo antiguo con significado hist√≥rico y hermosa arquitectura."},
{"name": "Water Sports Center", "type": "Deportes de aventura", "rating": 4.3, "description": "Jet ski, paseos en banana, windsurf y otras actividades acu√°ticas."},
{"name": "Bentota Railway Bridge", "type": "Puente", "rating": 4.0, "description": "Puente ferroviario hist√≥rico con vistas esc√©nicas del r√≠o Bentota."},
{"name": "Induruwa Beach", "type": "Playa", "rating": 4.2, "description": "Secci√≥n de playa menos concurrida ideal para nadar tranquilamente y relajarse."},
{"name": "Bawa's Bentota Beach Hotel", "type": "Arquitectura", "rating": 4.3, "description": "Hotel ic√≥nico dise√±ado por Geoffrey Bawa, obra maestra del modernismo tropical."}
],
"Hikkaduwa": [
{"name": "Hikkaduwa Beach", "type": "Playa", "rating": 4.5, "description": "Famosa por el surf, la vida nocturna, arrecifes de coral y una vibrante cultura de playa."},
{"name": "Hikkaduwa Coral Sanctuary", "type": "Santuario marino", "rating": 4.4, "description": "√Årea marina protegida con tours en barco de fondo de cristal y snorkel."},
{"name": "Tsunami Honganji Temple", "type": "Templo budista", "rating": 4.2, "description": "Templo de estilo japon√©s construido despu√©s del tsunami de 2004 como memorial."},
{"name": "Hikkaduwa Turtle Hatchery", "type": "Centro de conservaci√≥n", "rating": 4.3, "description": "Proyecto de conservaci√≥n que protege tortugas marinas y sus cr√≠as."},
{"name": "Narigama Beach", "type": "Playa", "rating": 4.4, "description": "Secci√≥n de playa menos concurrida con buenas condiciones para nadar y bares de playa."},
{"name": "Hikkaduwa National Park", "type": "Parque nacional", "rating": 4.3, "description": "Parque nacional marino que protege arrecifes de coral y biodiversidad marina."},
{"name": "Moonstone Mine", "type": "Mina", "rating": 4.0, "description": "√Årea de miner√≠a tradicional de piedra de luna que muestra la industria local de gemas."},
{"name": "Seenigama Temple", "type": "Templo hind√∫", "rating": 4.1, "description": "Templo antiguo en una peque√±a isla, accesible durante la marea baja."},
{"name": "Hikkaduwa Surf Point", "type": "Punto de surf", "rating": 4.5, "description": "Punto de surf popular con olas consistentes para principiantes y expertos."},
{"name": "Hikkaduwa Glass Bottom Boats", "type": "Tour en barco", "rating": 4.2, "description": "Tours en barcos de fondo de cristal para ver arrecifes de coral y vida marina sin mojarse."}
],
"Mirissa": [
{"name": "Mirissa Beach", "type": "Playa", "rating": 4.7, "description": "Playa pintoresca con palmeras, conocida por la observaci√≥n de ballenas y hermosos atardeceres."},
{"name": "Mirissa Whale Watching", "type": "Tour de vida silvestre", "rating": 4.6, "description": "Tours en barco para avistar ballenas azules, cachalotes y delfines en su h√°bitat natural."},
{"name": "Secret Beach", "type": "Playa", "rating": 4.5, "description": "Playa aislada accesible por un camino de jungla, perfecta para privacidad y relajaci√≥n."},
{"name": "Coconut Tree Hill", "type": "Punto de vista", "rating": 4.4, "description": "Punto de vista ic√≥nico con cocoteros y vistas panor√°micas al oc√©ano, perfecto para fotos."},
{"name": "Parrot Rock", "type": "Punto de vista", "rating": 4.3, "description": "Formaci√≥n rocosa con vistas panor√°micas de la playa de Mirissa y los alrededores."},
{"name": "Mirissa Fishing Harbour", "type": "Puerto", "rating": 4.0, "description": "Puerto de pesca activo con barcos coloridos, mariscos frescos y atm√≥sfera local."},
{"name": "Weligama Bay", "type": "Bah√≠a", "rating": 4.3, "description": "Bah√≠a cercana popular para lecciones de surf con olas suaves para principiantes."},
{"name": "Mirissa Marine Park", "type": "Parque marino", "rating": 4.2, "description": "√Årea marina protegida con diversa vida marina y formaciones coralinas."},
{"name": "Polhena Beach", "type": "Playa", "rating": 4.1, "description": "Playa protegida con aguas tranquilas ideal para nadar y snorkel."},
{"name": "Mirissa Cliff", "type": "Punto de vista", "rating": 4.3, "description": "√Årea de acantilado con restaurantes y bares que ofrecen vistas al atardecer sobre el oc√©ano."}
],
"Tangalle": [
{"name": "Tangalle Beach", "type": "Playa", "rating": 4.6, "description": "Larga playa impecable con arena dorada, formaciones rocosas y agua turquesa clara."},
{"name": "Rekawa Turtle Conservation Project", "type": "Centro de conservaci√≥n", "rating": 4.5, "description": "Playa de anidaci√≥n de tortugas con proyecto de conservaci√≥n y tours nocturnos de observaci√≥n de tortugas."},
{"name": "Hummanaya Blow Hole", "type": "Maravilla natural", "rating": 4.4, "description": "El √∫nico chorro de agua en Sri Lanka, donde el agua del mar sale disparada a trav√©s de formaciones rocosas."},
{"name": "Mulkirigala Rock Temple", "type": "Templo budista", "rating": 4.3, "description": "Templo rocoso antiguo con cuevas, frescos y vistas panor√°micas desde la cima."},
{"name": "Medaketiya Beach", "type": "Playa", "rating": 4.5, "description": "Playa aislada cerca de Tangalle, perfecta para nadar y relajarse."},
{"name": "Tangalle Fishing Harbor", "type": "Puerto", "rating": 4.0, "description": "Puerto de pesca tradicional con barcos coloridos y mercado de mariscos frescos."},
{"name": "Wewurukannala Temple", "type": "Templo budista", "rating": 4.2, "description": "Templo con la estatua de Buda sentado m√°s grande de Sri Lanka (50 metros de alto)."},
{"name": "Goyambokka Beach", "type": "Playa", "rating": 4.4, "description": "Hermosa playa protegida con aguas tranquilas, ideal para familias con ni√±os."},
{"name": "Kalametiya Bird Sanctuary", "type": "Santuario de aves", "rating": 4.3, "description": "√Årea de laguna y manglares perfecta para observaci√≥n de aves y safaris en barco."},
{"name": "Palm Paradise Cabanas", "type": "Resort de playa", "rating": 4.2, "description": "Alojamiento frente a la playa con caba√±as tradicionales y playa bordeada de palmeras."}
],
"Nuwara Eliya": [
{"name": "Gregory Lake", "type": "Lago", "rating": 4.3, "description": "Lago artificial esc√©nico con paseos en barco, equitaci√≥n, pedales en forma de cisne y hermosas vistas."},
{"name": "Horton Plains National Park", "type": "Parque nacional", "rating": 4.7, "description": "Sitio Patrimonio de la Humanidad de la UNESCO con senderos de senderismo al punto de vista World's End y la cascada Baker."},
{"name": "Tea Plantations", "type": "Plantaci√≥n", "rating": 4.6, "description": "Famosas plantaciones de t√© que ofrecen tours, visitas a f√°bricas y catas de t√© de Ceil√°n."},
{"name": "Victoria Park", "type": "Parque", "rating": 4.2, "description": "Hermoso jard√≠n bot√°nico con plantas ex√≥ticas, parterres de flores y observaci√≥n de aves."},
{"name": "Lover's Leap Waterfall", "type": "Cascada", "rating": 4.1, "description": "Cascada esc√©nica con senderos de senderismo, vistas a plantaciones de t√© y leyendas locales."},
{"name": "Single Tree Hill", "type": "Punto de vista", "rating": 4.4, "description": "El punto m√°s alto de Nuwara Eliya con vistas panor√°micas de 360 grados a las colinas circundantes."},
{"name": "Nuwara Eliya Golf Club", "type": "Campo de golf", "rating": 4.3, "description": "Uno de los campos de golf m√°s antiguos de Asia (1889) con vistas a las monta√±as y dise√±o desafiante."},
{"name": "Seetha Amman Temple", "type": "Templo hind√∫", "rating": 4.2, "description": "Templo colorido asociado con la epopeya del Ramayana, ubicado en Seetha Eliya."},
{"name": "Galway's Land National Park", "type": "Parque nacional", "rating": 4.0, "description": "Peque√±o parque nacional ideal para observaci√≥n de aves, paseos en la naturaleza y especies end√©micas."},
{"name": "Pedro Tea Estate", "type": "F√°brica de t√©", "rating": 4.3, "description": "Una de las f√°bricas de t√© m√°s antiguas de Sri Lanka que ofrece tours guiados y catas de t√©."}
],
"Ella": [
{"name": "Nine Arch Bridge", "type": "Puente", "rating": 4.8, "description": "Puente ferroviario ic√≥nico de la era colonial en medio de plantaciones de t√©, perfecto para fotograf√≠a."},
{"name": "Little Adam's Peak", "type": "Sendero de senderismo", "rating": 4.7, "description": "Sendero f√°cil con vistas panor√°micas del Ella Gap, monta√±as y plantaciones de t√©."},
{"name": "Ravana Falls", "type": "Cascada", "rating": 4.5, "description": "Hermosa cascada en cascada asociada con la leyenda del Ramayana, de 25 m de altura."},
{"name": "Ella Rock", "type": "Sendero de senderismo", "rating": 4.6, "description": "Sendero desafiante con vistas impresionantes de las colinas y valles circundantes."},
{"name": "Ella Spice Garden", "type": "Jard√≠n", "rating": 4.3, "description": "Tour educativo de especias, hierbas y plantas ayurv√©dicas tradicionales de Sri Lanka."},
{"name": "Ravana's Cave", "type": "Cueva", "rating": 4.2, "description": "Cueva hist√≥rica asociada con la epopeya del Ramayana, ubicada en acantilados cerca de Ella."},
{"name": "Ella Village", "type": "Pueblo", "rating": 4.4, "description": "Encantador pueblo de monta√±a con caf√©s, guesthouses, tiendas locales y atm√≥sfera amigable."},
{"name": "Demodara Loop", "type": "Ingenier√≠a ferroviaria", "rating": 4.3, "description": "Famosa bucle en espiral de ferrocarril, maravilla de ingenier√≠a donde el tren pasa sobre s√≠ mismo."},
{"name": "Ella Gap Viewpoint", "type": "Punto de vista", "rating": 4.5, "description": "Vistas espectaculares del valle, las llanuras del sur y monta√±as distantes."},
{"name": "Ella Train Station", "type": "Estaci√≥n de tren", "rating": 4.1, "description": "Estaci√≥n de tren pintoresca con arquitectura colonial y vistas a las monta√±as."}
],
"Badulla": [
{"name": "Dunhinda Falls", "type": "Cascada", "rating": 4.6, "description": "Magn√≠fica cascada de 64 m de altura, una de las m√°s hermosas de Sri Lanka."},
{"name": "Muthiyangana Raja Maha Viharaya", "type": "Templo budista", "rating": 4.3, "description": "Templo antiguo que se cree fue visitado por el Se√±or Buda, sitio de peregrinaci√≥n importante."},
{"name": "Badulla Park", "type": "Parque", "rating": 4.1, "description": "Parque central en la ciudad de Badulla con jardines, senderos de paseo y atm√≥sfera colonial."},
{"name": "St. Mark's Church", "type": "Iglesia", "rating": 4.0, "description": "Iglesia anglicana hist√≥rica construida en 1857 con hermosa arquitectura y vitrales."},
{"name": "Bogoda Wooden Bridge", "type": "Puente", "rating": 4.4, "description": "Puente de madera antiguo del siglo XVI, el puente de madera sobreviviente m√°s antiguo de Sri Lanka."},
{"name": "Halpewatte Tea Factory", "type": "F√°brica de t√©", "rating": 4.2, "description": "F√°brica de t√© que ofrece tours de procesamiento de t√© y catas de t√© de la regi√≥n de Uva."},
{"name": "Badulla Market", "type": "Mercado", "rating": 4.0, "description": "Mercado local con productos frescos, especias y bienes de las regiones circundantes."},
{"name": "Uma Oya", "type": "R√≠o", "rating": 4.2, "description": "Valle de r√≠o esc√©nico con cascadas, senderos de senderismo y puntos de nataci√≥n natural."},
{"name": "Kandyan Dance Show", "type": "Espect√°culo cultural", "rating": 4.3, "description": "Performances de danza kandyan tradicional que muestran la cultura de Sri Lanka."},
{"name": "Badulla Railway Station", "type": "Estaci√≥n de tren", "rating": 4.1, "description": "Estaci√≥n de tren hist√≥rica al final de la famosa ruta de tren Colombo-Badulla."}
],
"Bandarawela": [
{"name": "Dowa Rock Temple", "type": "Templo budista", "rating": 4.4, "description": "Templo rocoso antiguo con talla de Buda inacabada y pinturas de cuevas."},
{"name": "Bandarawela Town", "type": "Pueblo", "rating": 4.2, "description": "Encantador pueblo de colinas con arquitectura colonial y clima fresco."},
{"name": "Adisham Bungalow", "type": "Casa hist√≥rica", "rating": 4.3, "description": "Monasterio de estilo casa de campo inglesa con hermosos jardines y arquitectura."},
{"name": "Lipton's Seat", "type": "Punto de vista", "rating": 4.7, "description": "Famoso punto de vista donde Sir Thomas Lipton inspeccion√≥ su imperio del t√©, vistas panor√°micas."},
{"name": "St. Andrew's Church", "type": "Iglesia", "rating": 4.1, "description": "Iglesia hist√≥rica construida en 1908 con hermosos vitrales y arquitectura."},
{"name": "Bandarawela Golf Club", "type": "Campo de golf", "rating": 4.2, "description": "Campo de golf de 9 hoyos con vistas a las monta√±as y terreno desafiante."},
{"name": "Bandarawela Market", "type": "Mercado", "rating": 4.0, "description": "Mercado local con vegetales frescos de las colinas, frutas y productos locales."},
{"name": "Diyaluma Falls", "type": "Cascada", "rating": 4.5, "description": "Segunda cascada m√°s alta de Sri Lanka (220 m), con piscinas infinitas naturales en la cima."},
{"name": "Bandarawela Railway Station", "type": "Estaci√≥n de tren", "rating": 4.1, "description": "Estaci√≥n de tren hist√≥rica en la l√≠nea principal, entorno monta√±oso hermoso."},
{"name": "Haputale", "type": "Pueblo cercano", "rating": 4.3, "description": "Pueblo de colinas cercano con plantaciones de t√© y vistas impresionantes de las llanuras del sur."}
],
"Hatton": [
{"name": "Adam's Peak", "type": "Monta√±a", "rating": 4.8, "description": "Sitio de peregrinaci√≥n sagrado de monta√±a con vistas al amanecer y santuario de la huella de Buda."},
{"name": "St. Clair's Falls", "type": "Cascada", "rating": 4.5, "description": "Cascada m√°s ancha de Sri Lanka, conocida como el 'Peque√±o Ni√°gara de Sri Lanka'."},
{"name": "Devon Falls", "type": "Cascada", "rating": 4.4, "description": "Cascada de 97 m de altura nombrada por un plantador de caf√© ingl√©s, visible desde la carretera principal."},
{"name": "Hatton Town", "type": "Pueblo", "rating": 4.1, "description": "Pueblo principal que sirve a los peregrinos de Adam's Peak y las plantaciones de t√© circundantes."},
{"name": "Castlereagh Reservoir", "type": "Embalse", "rating": 4.3, "description": "Hermoso embalse rodeado de plantaciones de t√©, perfecto para fotograf√≠a."},
{"name": "Gartmore Falls", "type": "Cascada", "rating": 4.2, "description": "Cascada menos conocida cerca de Hatton, accesible a trav√©s de caminos en fincas de t√©."},
{"name": "Tea Plantation Tours", "type": "Plantaci√≥n", "rating": 4.4, "description": "Tours guiados por plantaciones de t√© para aprender sobre la producci√≥n y procesamiento del t√©."},
{"name": "Hatton Market", "type": "Mercado", "rating": 4.0, "description": "Mercado local que sirve a las comunidades de las colinas con productos frescos y bienes."},
{"name": "Laxapana Falls", "type": "Cascada", "rating": 4.3, "description": "Cascada de 129 m de altura, una de las m√°s altas de Sri Lanka, ubicada cerca de una central hidroel√©ctrica."},
{"name": "Adam's Peak Base Camps", "type": "Sitio de peregrinaci√≥n", "rating": 4.2, "description": "Puntos de partida para el peregrinaje de Adam's Peak con guesthouses e instalaciones."}
],
"Sigiriya": [
{"name": "Sigiriya Rock Fortress", "type": "Sitio arqueol√≥gico", "rating": 4.9, "description": "Sitio Patrimonio de la Humanidad de la UNESCO, antigua fortaleza rocosa con frescos, jardines y ruinas de palacio."},
{"name": "Pidurangala Rock", "type": "Sendero de senderismo", "rating": 4.7, "description": "Sendero alternativo con las mejores vistas de la Roca de Sigiriya, especialmente al amanecer."},
{"name": "Sigiriya Museum", "type": "Museo", "rating": 4.2, "description": "Museo moderno que explica la historia, arqueolog√≠a y esfuerzos de conservaci√≥n de Sigiriya."},
{"name": "Sigiriya Frescoes", "type": "Arte antiguo", "rating": 4.6, "description": "Famosos pinturas antiguas de ninfas celestiales en un bolsillo rocoso protegido."},
{"name": "Mirror Wall", "type": "Elemento arqueol√≥gico", "rating": 4.3, "description": "Muro antiguo pulido con grafitis hist√≥ricos de los siglos VIII-X."},
{"name": "Water Gardens", "type": "Jardines", "rating": 4.4, "description": "Ingenier√≠a hidr√°ulica antigua sofisticada con piscinas, fuentes y jardines."},
{"name": "Lion's Paw Terrace", "type": "Elemento arqueol√≥gico", "rating": 4.5, "description": "Restos de la gigantesca estatua de le√≥n que formaba la entrada al palacio de la cima."},
{"name": "Boulder Gardens", "type": "Jardines", "rating": 4.2, "description": "Complejo de jardines antiguo con rocas naturales, senderos y pabellones."},
{"name": "Sigiriya Village Tour", "type": "Tour cultural", "rating": 4.3, "description": "Tours culturales de pueblos locales para experimentar la vida tradicional de Sri Lanka."},
{"name": "Elephant Safari", "type": "Safari de vida silvestre", "rating": 4.4, "description": "Safaris a lomo de elefante a trav√©s de bosques y campos circundantes."}
],
"Dambulla": [
{"name": "Dambulla Cave Temple", "type": "Templo budista", "rating": 4.8, "description": "Sitio Patrimonio de la Humanidad de la UNESCO con cinco cuevas que contienen estatuas de Buda y murales."},
{"name": "Golden Temple of Dambulla", "type": "Templo budista", "rating": 4.4, "description": "Gran estatua de Buda dorada y museo en la base del complejo de templo en cueva."},
{"name": "Rose Quartz Mountain", "type": "Monta√±a", "rating": 4.3, "description": "Monta√±a √∫nica con dep√≥sitos de cuarzo rosa y senderos de senderismo con vistas panor√°micas."},
{"name": "Ibbankatuwa Megalithic Tombs", "type": "Sitio arqueol√≥gico", "rating": 4.0, "description": "Sitio de entierro antiguo que data del 700 a.C. con arreglos de piedra."},
{"name": "Dambulla Market", "type": "Mercado", "rating": 4.1, "description": "Mercado local vibrante con especias, frutas, vegetales y productos locales."},
{"name": "Na Uyana Aranya", "type": "Monasterio forestal", "rating": 4.5, "description": "Gran monasterio forestal con oportunidades de meditaci√≥n y alrededores pac√≠ficos."},
{"name": "Dambulla Dedicated Economic Centre", "type": "Mercado", "rating": 4.0, "description": "Gran mercado mayorista de frutas y vegetales de las granjas circundantes."},
{"name": "Spice Gardens", "type": "Jard√≠n", "rating": 4.2, "description": "Tours educativos de jardines de especias que muestran especias e hierbas de Sri Lanka."},
{"name": "Kandalama Hotel", "type": "Arquitectura", "rating": 4.6, "description": "Hotel ic√≥nico dise√±ado por Geoffrey Bawa, que se fusiona con el paisaje natural."},
{"name": "Dambulla Cricket Stadium", "type": "Instalaci√≥n deportiva", "rating": 4.1, "description": "Estadio de cricket internacional que alberga partidos de prueba y un d√≠a internacional."}
],
"Polonnaruwa": [
{"name": "Ancient City of Polonnaruwa", "type": "Sitio arqueol√≥gico", "rating": 4.8, "description": "Sitio Patrimonio de la Humanidad de la UNESCO con ruinas bien preservadas de la antigua capital medieval de Sri Lanka."},
{"name": "Gal Vihara", "type": "Estatuas budistas", "rating": 4.7, "description": "Famoso templo rocoso con cuatro magn√≠ficas estatuas de Buda talladas en una sola roca de granito."},
{"name": "Parakrama Samudra", "type": "Embalse antiguo", "rating": 4.5, "description": "Enorme embalse antiguo construido por el rey Parakramabahu, que cubre 2.500 hect√°reas."},
{"name": "Polonnaruwa Vatadage", "type": "Estructura antigua", "rating": 4.6, "description": "Casa circular de reliquias con tallas intrincadas en piedra y piedras lunares."},
{"name": "Lankatilaka Temple", "type": "Templo budista", "rating": 4.4, "description": "Imponente templo de ladrillo con estatua masiva de Buda y grandeza arquitect√≥nica."},
{"name": "Royal Palace Complex", "type": "Sitio arqueol√≥gico", "rating": 4.3, "description": "Ruinas del antiguo palacio real, c√°mara del consejo y ba√±os reales."},
{"name": "Archaeological Museum", "type": "Museo", "rating": 4.1, "description": "Museo que muestra artefactos, esculturas e informaci√≥n del per√≠odo de Polonnaruwa."},
{"name": "Shiva Devale", "type": "Templo hind√∫", "rating": 4.2, "description": "Antiguos templos hind√∫es que muestran influencia arquitect√≥nica sudindia."},
{"name": "Statue of King Parakramabahu", "type": "Monumento", "rating": 4.3, "description": "Estatua de piedra que se cree representa al rey Parakramabahu I sosteniendo un manuscrito en hoja de palma."},
{"name": "Polonnaruwa Quadrangle", "type": "Sitio arqueol√≥gico", "rating": 4.5, "description": "Cuadril√°tero sagrado que contiene los monumentos religiosos m√°s importantes en un √°rea compacta."}
],
"Anuradhapura": [
{"name": "Sacred City of Anuradhapura", "type": "Sitio arqueol√≥gico", "rating": 4.8, "description": "Sitio Patrimonio de la Humanidad de la UNESCO, antigua capital con sitios budistas sagrados que datan del siglo IV a.C."},
{"name": "Sri Maha Bodhi", "type": "√Årbol sagrado", "rating": 4.9, "description": "El √°rbol documentado hist√≥ricamente m√°s antiguo del mundo, crecido de una rama del √°rbol de iluminaci√≥n de Buda."},
{"name": "Ruwanwelisaya Stupa", "type": "Stupa budista", "rating": 4.7, "description": "Enorme stupa blanca construida por el rey Dutugemunu, una de las m√°s reverenciadas de Sri Lanka."},
{"name": "Jetavanaramaya Stupa", "type": "Stupa budista", "rating": 4.6, "description": "Una de las estructuras antiguas m√°s altas del mundo cuando se construy√≥ (122 m)."},
{"name": "Abhayagiri Monastery", "type": "Complejo mon√°stico", "rating": 4.5, "description": "Complejo mon√°stico antiguo con museo, estanques gemelos y stupa masiva."},
{"name": "Isurumuniya Temple", "type": "Templo budista", "rating": 4.4, "description": "Templo rocoso famoso por sus tallas en roca, incluyendo los 'Amantes de Isurumuniya'."},
{"name": "Samadhi Buddha Statue", "type": "Estatua budista", "rating": 4.6, "description": "Famosa estatua de Buda de granito en pose de meditaci√≥n, considerada obra maestra de la escultura antigua."},
{"name": "Kuttam Pokuna", "type": "Estanques antiguos", "rating": 4.3, "description": "Estanques gemelos que muestran la ingenier√≠a y simetr√≠a sinhalesa antigua."},
{"name": "Mihintale", "type": "Monta√±a sagrada", "rating": 4.7, "description": "Lugar de nacimiento del budismo en Sri Lanka, sitio de peregrinaci√≥n con templos y stupas."},
{"name": "Archaeological Museum", "type": "Museo", "rating": 4.2, "description": "Museo que muestra artefactos del per√≠odo de Anuradhapura y explica la historia del sitio."}
],
"Trincomalee": [
{"name": "Nilaveli Beach", "type": "Playa", "rating": 4.7, "description": "Una de las playas m√°s hermosas de Sri Lanka con arena blanca y agua turquesa clara."},
{"name": "Pigeon Island National Park", "type": "Parque nacional", "rating": 4.6, "description": "Parque nacional marino ideal para snorkel, buceo y exploraci√≥n de arrecifes de coral."},
{"name": "Fort Frederick", "type": "Fortaleza", "rating": 4.3, "description": "Fortaleza hist√≥rica construida por portugueses y expandida por holandeses, ahora alberga una base militar."},
{"name": "Koneswaram Temple", "type": "Templo hind√∫", "rating": 4.5, "description": "Complejo de templo hind√∫ antiguo en la Roca Swami con vistas panor√°micas al oc√©ano."},
{"name": "Marble Beach", "type": "Playa", "rating": 4.4, "description": "Playa aislada con arena como m√°rmol y agua cristalina, dentro de una base de la fuerza a√©rea."},
{"name": "Uppuveli Beach", "type": "Playa", "rating": 4.3, "description": "Larga playa de arena popular para nadar, deportes acu√°ticos y alojamiento frente a la playa."},
{"name": "Trinco Whale Watching", "type": "Tour de vida silvestre", "rating": 4.5, "description": "Tours de observaci√≥n de ballenas en la Bah√≠a de Bengala para avistar ballenas azules y delfines."},
{"name": "Lovers' Leap", "type": "Punto de vista", "rating": 4.2, "description": "Punto de vista en acantilado con leyenda de amor tr√°gico y vistas al oc√©ano."},
{"name": "Trincomalee War Cemetery", "type": "Memorial", "rating": 4.1, "description": "Cementerio de guerra de la Commonwealth que honra a soldados de la Segunda Guerra Mundial."},
{"name": "Trincomalee Harbor", "type": "Puerto", "rating": 4.0, "description": "Uno de los mejores puertos naturales del mundo, el quinto puerto natural m√°s grande globalmente."}
],
"Batticaloa": [
{"name": "Batticaloa Lagoon", "type": "Laguna", "rating": 4.4, "description": "La segunda laguna m√°s grande de Sri Lanka, perfecta para paseos en barco, observaci√≥n de aves y vistas al atardecer."},
{"name": "Kallady Bridge", "type": "Puente", "rating": 4.2, "description": "Puente ic√≥nico de la era holandesa que conecta la ciudad de Batticaloa con Kallady, conocido por el fen√≥meno de los peces cantores."},
{"name": "Batticaloa Fort", "type": "Fortaleza", "rating": 4.3, "description": "Fortaleza holandesa construida en 1628, que domina la laguna con significado hist√≥rico y arquitectura."},
{"name": "Pasikudah Beach", "type": "Playa", "rating": 4.6, "description": "Una de las mejores playas de Sri Lanka con aguas turquesas poco profundas, perfecta para nadar."},
{"name": "Kalkudah Beach", "type": "Playa", "rating": 4.5, "description": "Larga playa plana ideal para nadar, windsurf y deportes acu√°ticos con olas suaves."},
{"name": "St. Mary's Cathedral", "type": "Iglesia", "rating": 4.2, "description": "Hermosa catedral cat√≥lica con arquitectura impresionante en el coraz√≥n de Batticaloa."},
{"name": "Batticaloa Lighthouse", "type": "Faro", "rating": 4.1, "description": "Faro hist√≥rico en el borde de la Laguna de Batticaloa con vistas panor√°micas."},
{"name": "Navatkuli Bridge", "type": "Puente", "rating": 4.0, "description": "Puente de la era brit√°nica con vistas esc√©nicas de la laguna y el paisaje circundante."},
{"name": "Koddamunai Hindu Temple", "type": "Templo hind√∫", "rating": 4.3, "description": "Templo hind√∫ prominente que muestra arquitectura tamil y significado cultural."},
{"name": "Batticaloa Dutch Bar Heritage Museum", "type": "Museo", "rating": 4.1, "description": "Museo en un edificio restaurado de la era holandesa que muestra historia colonial y artefactos."}
],
"Pasikudah": [
{"name": "Pasikudah Beach", "type": "Playa", "rating": 4.7, "description": "Famosa por sus aguas turquesas tranquilas y poco profundas que se extienden 100-200 m desde la orilla, perfecta para nadar."},
{"name": "Coral Reefs", "type": "Vida marina", "rating": 4.5, "description": "Arrecifes de coral protegidos ideales para snorkel y observaci√≥n de biodiversidad marina."},
{"name": "Kalkudah Beach", "type": "Playa", "rating": 4.6, "description": "Playa adyacente con aguas poco profundas similares, menos desarrollada y m√°s natural."},
{"name": "Water Sports Center", "type": "Deportes de aventura", "rating": 4.3, "description": "Jet ski, paseos en banana, kayak y otras actividades acu√°ticas."},
{"name": "Beach Resorts", "type": "Alojamiento", "rating": 4.4, "description": "Resorts de lujo frente a la playa con instalaciones de spa, piscinas y cocina fina."},
{"name": "Sunset Views", "type": "Punto de vista", "rating": 4.6, "description": "Atardeceres espectaculares sobre la Bah√≠a de Bengala con colores reflejados en las aguas tranquilas."},
{"name": "Beach Walks", "type": "Actividad de playa", "rating": 4.4, "description": "Largos paseos pac√≠ficos a lo largo de la orilla impecable, especialmente agradables al amanecer."},
{"name": "Local Fishing Village", "type": "Experiencia cultural", "rating": 4.2, "description": "Visite un pueblo de pesca tradicional para ver el estilo de vida local y t√©cnicas de pesca."},
{"name": "Beachfront Dining", "type": "Comida", "rating": 4.3, "description": "Restaurantes que sirven mariscos frescos con vistas a la playa y brisa oce√°nica."},
{"name": "Paddle Boarding", "type": "Deporte acu√°tico", "rating": 4.4, "description": "Stand-up paddle boarding en aguas tranquilas y poco profundas adecuado para principiantes."}
],
"Arugam Bay": [
{"name": "Arugam Bay Beach", "type": "Playa", "rating": 4.7, "description": "Destino de surf de clase mundial con olas consistentes, ambiente relajado y hermosa playa."},
{"name": "Pottuvil Point", "type": "Punto de surf", "rating": 4.6, "description": "Famoso punto de ruptura de surf para surfistas experimentados, mejor durante la temporada de abril-octubre."},
{"name": "Lahugala National Park", "type": "Parque nacional", "rating": 4.3, "description": "Santuario de elefantes con agujeros de agua naturales, observaci√≥n de aves y vida silvestre."},
{"name": "Muhudu Maha Viharaya", "type": "Templo budista", "rating": 4.2, "description": "Templo antiguo con ubicaci√≥n frente a la playa y significado arqueol√≥gico."},
{"name": "Elephant Rock", "type": "Punto de vista", "rating": 4.4, "description": "Punto de senderismo con vistas panor√°micas de Arugam Bay y la costa circundante."},
{"name": "Panama Beach", "type": "Playa", "rating": 4.5, "description": "Playa aislada ideal para nadar, relajarse y escapar de las multitudes."},
{"name": "Surf Schools", "type": "Lecciones de surf", "rating": 4.5, "description": "Escuelas de surf profesionales que ofrecen lecciones para principiantes e intermedios."},
{"name": "Crocodile Rock", "type": "Punto de surf", "rating": 4.4, "description": "Punto de surf nombrado por una formaci√≥n rocosa en forma de cocodrilo, adecuado para surfistas experimentados."},
{"name": "Arugam Bay Lagoon", "type": "Laguna", "rating": 4.3, "description": "Laguna tranquila perfecta para kayak, paddle boarding y observaci√≥n de aves."},
{"name": "Beach Bars", "type": "Vida nocturna", "rating": 4.2, "description": "Bares y restaurantes frente a la playa con m√∫sica en vivo, fogatas y cocina internacional."}
],
"Jaffna": [
{"name": "Jaffna Fort", "type": "Fortaleza", "rating": 4.4, "description": "Fortaleza holandesa construida en 1680, una de las mejor preservadas de Sri Lanka."},
{"name": "Nallur Kandaswamy Temple", "type": "Templo hind√∫", "rating": 4.7, "description": "Gran complejo de templo hind√∫, el m√°s significativo de Jaffna, famoso por su festival anual."},
{"name": "Jaffna Public Library", "type": "Biblioteca", "rating": 4.3, "description": "Biblioteca ic√≥nica que simboliza el patrimonio tamil y la revival, reconstruida despu√©s del incendio de 1981."},
{"name": "Nagadeepa Purana Viharaya", "type": "Templo budista", "rating": 4.5, "description": "Templo budista antiguo en la isla de Nagadeepa, accesible por ferry."},
{"name": "Keerimalai Springs", "type": "Fuentes naturales", "rating": 4.2, "description": "Fuentes de agua dulce naturales con estanques de ba√±o separados para hombres y mujeres."},
{"name": "Jaffna Market", "type": "Mercado", "rating": 4.1, "description": "Mercado local bullicioso con productos frescos, dulces tamiles y experiencia cultural."},
{"name": "Casuarina Beach", "type": "Playa", "rating": 4.3, "description": "Hermosa playa con √°rboles de casuarina, ideal para paseos al atardecer y relajaci√≥n."},
{"name": "Point Pedro", "type": "Pueblo", "rating": 4.2, "description": "Punto m√°s septentrional de Sri Lanka con faro y puerto de pesca."},
{"name": "Kankesanturai Beach", "type": "Playa", "rating": 4.3, "description": "Playa impecable cerca del puerto de Kankesanturai, menos concurrida con belleza natural."},
{"name": "Jaffna Archaeological Museum", "type": "Museo", "rating": 4.0, "description": "Museo que muestra artefactos del reino de Jaffna y patrimonio cultural hind√∫."}
],
"Mannar": [
{"name": "Adam's Bridge", "type": "Formaci√≥n natural", "rating": 4.5, "description": "Cadena de bancos de arena caliza entre India y Sri Lanka, visible desde Mannar."},
{"name": "Mannar Fort", "type": "Fortaleza", "rating": 4.2, "description": "Fortaleza portuguesa luego holandesa que domina el Golfo de Mannar, construida en 1560."},
{"name": "Baobab Tree", "type": "√Årbol", "rating": 4.4, "description": "√Årbol baobab antiguo que se cree tiene 700 a√±os, tra√≠do por comerciantes √°rabes."},
{"name": "Mannar Island", "type": "Isla", "rating": 4.3, "description": "Isla conectada al continente por un dique, conocida por la producci√≥n de sal y pesca."},
{"name": "Thanthirimale Temple", "type": "Templo budista", "rating": 4.3, "description": "Templo antiguo con inscripciones en roca y conexiones con la llegada del budismo."},
{"name": "Giant's Tank", "type": "Embalse", "rating": 4.1, "description": "Embalse de irrigaci√≥n antiguo construido por el rey Dhatusena en el siglo V d.C."},
{"name": "Mannar Beach", "type": "Playa", "rating": 4.2, "description": "Larga playa ventosa con oportunidades para recolectar conchas y vistas al atardecer."},
{"name": "Our Lady of Madhu Church", "type": "Iglesia", "rating": 4.4, "description": "Importante sitio de peregrinaci√≥n cat√≥lico con santuario de Nuestra Se√±ora de Madhu."},
{"name": "Mannar Market", "type": "Mercado", "rating": 4.0, "description": "Mercado local con mariscos, pescado seco y productos √∫nicos de la regi√≥n de Mannar."},
{"name": "Birdwatching Sites", "type": "Santuario de aves", "rating": 4.3, "description": "√Årea importante para aves migratorias incluyendo flamencos durante la temporada."}
],
"Vavuniya": [
{"name": "Vavuniya Museum", "type": "Museo", "rating": 4.1, "description": "Museo local que muestra artefactos e informaci√≥n sobre la regi√≥n de Vavuniya."},
{"name": "Kandasamy Kovil", "type": "Templo hind√∫", "rating": 4.2, "description": "Templo hind√∫ prominente en Vavuniya con arquitectura colorida."},
{"name": "Vavuniya Tank", "type": "Embalse", "rating": 4.0, "description": "Embalse de irrigaci√≥n antiguo que proporciona agua a las √°reas agr√≠colas circundantes."},
{"name": "Pandivirichchan Thermal Springs", "type": "Fuentes termales", "rating": 4.3, "description": "Fuentes termales naturales que se cree tienen propiedades medicinales."},
{"name": "Vavuniya Market", "type": "Mercado", "rating": 4.0, "description": "Mercado principal que sirve a la regi√≥n norte con bienes diversos y productos."},
{"name": "Sivapuram Temple", "type": "Templo hind√∫", "rating": 4.1, "description": "Templo antiguo con significado cultural y religioso."},
{"name": "Vavuniya Town", "type": "Pueblo", "rating": 4.0, "description": "Pueblo puerta de entrada a la provincia norte con importancia administrativa y comercial."},
{"name": "Agriculture Farms", "type": "Granja", "rating": 4.1, "description": "Visite granjas locales para ver el cultivo de cultivos como cebollas, chiles y granos."},
{"name": "Community Projects", "type": "Experiencia cultural", "rating": 4.2, "description": "Iniciativas de turismo comunitario que muestran la vida y tradiciones locales."},
{"name": "Historical Sites", "type": "Sitio arqueol√≥gico", "rating": 4.1, "description": "Varios sitios hist√≥ricos que reflejan el diverso patrimonio cultural de la regi√≥n."}
],
"Yala": [
{"name": "Yala National Park", "type": "Parque nacional", "rating": 4.8, "description": "El parque de vida silvestre m√°s famoso de Sri Lanka para avistamientos de leopardos y elefantes, ecosistemas diversos."},
{"name": "Sithulpawwa Rajamaha Viharaya", "type": "Monasterio budista", "rating": 4.4, "description": "Templo rocoso antiguo con significado arqueol√≥gico y cuevas de meditaci√≥n."},
{"name": "Kumana National Park", "type": "Parque nacional", "rating": 4.6, "description": "Para√≠so para observadores de aves adyacente a Yala, conocido por aves migratorias y lagunas."},
{"name": "Patangala", "type": "Sitio arqueol√≥gico", "rating": 4.2, "description": "Complejo de cuevas antiguo con inscripciones en brahmi e importancia arqueol√≥gica."},
{"name": "Yala Safari Experience", "type": "Safari de vida silvestre", "rating": 4.7, "description": "Safaris en jeep para avistar leopardos, elefantes, osos perezosos y diversa vida silvestre."},
{"name": "Yala Village", "type": "Pueblo local", "rating": 4.0, "description": "Experimente la cultura local y la vida tradicional de Sri Lanka en pueblos cercanos."},
{"name": "Yala Beach", "type": "Playa", "rating": 4.3, "description": "Playa impecable dentro del Parque Nacional de Yala con tortugas anidando."},
{"name": "Buttala", "type": "Pueblo", "rating": 3.9, "description": "Pueblo cercano con mercados locales, templos y sitios culturales."},
{"name": "Magul Maha Viharaya", "type": "Templo budista", "rating": 4.2, "description": "Templo antiguo que se cree es donde el rey Kavantissa se cas√≥ con la princesa Viharamahadevi."},
{"name": "Wildlife Photography", "type": "Fotograf√≠a", "rating": 4.6, "description": "Excelentes oportunidades para fotograf√≠a de vida silvestre con gu√≠as profesionales."}
],
"Udawalawe": [
{"name": "Udawalawe National Park", "type": "Parque nacional", "rating": 4.7, "description": "El mejor lugar en Sri Lanka para ver elefantes en grandes manadas, tambi√©n hogar de otra vida silvestre."},
{"name": "Udawalawe Elephant Transit Home", "type": "Centro de conservaci√≥n", "rating": 4.6, "description": "Orfanato de elefantes donde los elefantes beb√©s son cuidados antes de liberarlos a la naturaleza."},
{"name": "Udawalawe Reservoir", "type": "Embalse", "rating": 4.4, "description": "Gran embalse de irrigaci√≥n que atrae aves y vida silvestre, vistas esc√©nicas."},
{"name": "Safari Tours", "type": "Safari de vida silvestre", "rating": 4.7, "description": "Safaris en jeep a trav√©s del parque nacional para ver elefantes, aves y otros animales."},
{"name": "Birdwatching", "type": "Santuario de aves", "rating": 4.5, "description": "Excelente observaci√≥n de aves con m√°s de 200 especies de aves, incluyendo muchas end√©micas."},
{"name": "Elephant Feeding", "type": "Experiencia de vida silvestre", "rating": 4.3, "description": "Observe las horas de alimentaci√≥n en el orfanato de elefantes (3 veces al d√≠a)."},
{"name": "Butterfly Park", "type": "Parque", "rating": 4.1, "description": "Parque que muestra las diversas especies de mariposas de Sri Lanka y sus ciclos de vida."},
{"name": "Local Villages", "type": "Experiencia cultural", "rating": 4.2, "description": "Visite pueblos tradicionales para ver la vida rural de Sri Lanka y la agricultura."},
{"name": "Scenic Drives", "type": "Ruta esc√©nica", "rating": 4.3, "description": "Hermosos paseos en coche a trav√©s de paisajes rurales y vistas al embalse."},
{"name": "Conservation Education", "type": "Educativo", "rating": 4.4, "description": "Programas educativos sobre conservaci√≥n de elefantes y protecci√≥n de vida silvestre."}
],
"Wilpattu": [
{"name": "Wilpattu National Park", "type": "Parque nacional", "rating": 4.7, "description": "El parque nacional m√°s grande de Sri Lanka conocido por lagos naturales (villus) y avistamientos de leopardos."},
{"name": "Safari Tours", "type": "Safari de vida silvestre", "rating": 4.6, "description": "Safaris en jeep de d√≠a completo para explorar h√°bitats diversos y avistar vida silvestre."},
{"name": "Leopard Tracking", "type": "Experiencia de vida silvestre", "rating": 4.5, "description": "Tours especializados enfocados en avistamientos de leopardos y observaci√≥n de comportamiento."},
{"name": "Birdwatching", "type": "Santuario de aves", "rating": 4.4, "description": "M√°s de 200 especies de aves incluyendo muchas migratorias y end√©micas."},
{"name": "Natural Lakes (Villus)", "type": "Lagos", "rating": 4.3, "description": "Lagos naturales caracter√≠sticos que dan a Wilpattu su nombre (Tierra de Lagos)."},
{"name": "Kudiramalai Point", "type": "Sitio hist√≥rico", "rating": 4.2, "description": "Sitio hist√≥rico con significado arqueol√≥gico y vistas al oc√©ano."},
{"name": "Ancient Ruins", "type": "Sitio arqueol√≥gico", "rating": 4.1, "description": "Restos de civilizaciones antiguas dentro de los l√≠mites del parque."},
{"name": "Wildlife Photography", "type": "Fotograf√≠a", "rating": 4.6, "description": "Excelentes oportunidades para fotograf√≠a de vida silvestre y paisajes."},
{"name": "Camping", "type": "Camping", "rating": 4.3, "description": "Experiencias de camping de vida silvestre en √°reas designadas del parque."},
{"name": "Conservation Areas", "type": "Conservaci√≥n", "rating": 4.4, "description": "√Åreas protegidas que muestran el compromiso de Sri Lanka con la conservaci√≥n de vida silvestre."}
],
"Kitulgala": [
{"name": "White Water Rafting", "type": "Deportes de aventura", "rating": 4.7, "description": "El mejor rafting en aguas blancas de Sri Lanka en el r√≠o Kelani con r√°pidos de grado 2-3."},
{"name": "Belilena Cave", "type": "Cueva", "rating": 4.4, "description": "Cueva arqueol√≥gica donde se descubrieron restos humanos de 12.000 a√±os."},
{"name": "Kitulgala Forest Reserve", "type": "Reserva forestal", "rating": 4.5, "description": "√Årea de selva tropical hermosa con senderos de senderismo y biodiversidad."},
{"name": "The Bridge on the River Kwai", "type": "Ubicaci√≥n de pel√≠cula", "rating": 4.3, "description": "Ubicaci√≥n donde se rod√≥ la pel√≠cula de 1957, aunque el puente fue destruido para la pel√≠cula."},
{"name": "Waterfall Abseiling", "type": "Deportes de aventura", "rating": 4.6, "description": "Descenso en rappel por cascadas en √°reas de jungla circundantes."},
{"name": "Jungle Trekking", "type": "Sendero de senderismo", "rating": 4.4, "description": "Senderos guiados a trav√©s de la selva tropical para ver vida silvestre y cascadas."},
{"name": "Birdwatching", "type": "Santuario de aves", "rating": 4.3, "description": "Excelente observaci√≥n de aves con muchas especies end√©micas de Sri Lanka."},
{"name": "Canyoning", "type": "Deportes de aventura", "rating": 4.5, "description": "Aventuras de canyoning que combinan escalada, nataci√≥n y saltos."},
{"name": "Kayaking", "type": "Deporte acu√°tico", "rating": 4.4, "description": "Kayak en el r√≠o Kelani a trav√©s de gargantas esc√©nicas y r√°pidos."},
{"name": "Camping", "type": "Camping", "rating": 4.3, "description": "Experiencias de camping junto al r√≠o con fogatas e inmersi√≥n en la naturaleza."}
],
"Ratnapura": [
{"name": "Gem Mines", "type": "Mina", "rating": 4.5, "description": "Visite minas de gemas en funcionamiento para ver la extracci√≥n de piedras preciosas incluyendo zafiros y rub√≠es."},
{"name": "Gemological Museum", "type": "Museo", "rating": 4.3, "description": "Museo que muestra la industria de gemas de Sri Lanka, historia y piedras preciosas."},
{"name": "Sinharaja Forest Reserve", "type": "Reserva forestal", "rating": 4.7, "description": "Sitio Patrimonio de la Humanidad de la UNESCO, punto caliente de biodiversidad con especies end√©micas."},
{"name": "Bopath Falls", "type": "Cascada", "rating": 4.4, "description": "Cascada en forma de hoja de Bo (higuera sagrada), de 30 m de altura con piscina para nadar."},
{"name": "Ratnapura Market", "type": "Mercado", "rating": 4.2, "description": "Famoso mercado de gemas donde los comerciantes compran y venden piedras preciosas."},
{"name": "Mahaweli River", "type": "R√≠o", "rating": 4.1, "description": "El r√≠o m√°s largo de Sri Lanka, puntos esc√©nicos para picnics y ba√±os en el r√≠o."},
{"name": "Gem Cutting Workshops", "type": "Taller", "rating": 4.3, "description": "Vea t√©cnicas tradicionales de corte y pulido de gemas por artesanos calificados."},
{"name": "Ancient Temples", "type": "Templo budista", "rating": 4.2, "description": "Varios templos antiguos en y alrededor de Ratnapura con significado hist√≥rico."},
{"name": "Tea Estates", "type": "Plantaci√≥n", "rating": 4.3, "description": "Plantaciones de t√© en las colinas circundantes que producen t√© de baja altitud de calidad."},
{"name": "Agricultural Farms", "type": "Granja", "rating": 4.1, "description": "Granja que produce especias, frutas y vegetales en la f√©rtil regi√≥n de Ratnapura."}
],
"Kalutara": [
{"name": "Kalutara Bodhiya", "type": "Templo budista", "rating": 4.4, "description": "√Årbol Bodhi sagrado y complejo de templo con hermosa stupa blanca."},
{"name": "Kalutara Beach", "type": "Playa", "rating": 4.3, "description": "Larga playa de arena popular para nadar, vistas al atardecer y deportes acu√°ticos."},
{"name": "Richmond Castle", "type": "Casa hist√≥rica", "rating": 4.2, "description": "Mansi√≥n colonial construida en 1896, ahora centro cultural con jardines."},
{"name": "Kalu Ganga River", "type": "R√≠o", "rating": 4.1, "description": "Paseos y experiencias de pesca en el r√≠o hom√≥nimo de Kalutara."},
{"name": "Fa Hien Cave", "type": "Cueva", "rating": 4.3, "description": "Cueva arqueol√≥gica donde se descubrieron restos de humanos prehist√≥ricos."},
{"name": "Kalutara Temple", "type": "Templo budista", "rating": 4.2, "description": "Stupa hueca que contiene una stupa m√°s peque√±a en su interior, caracter√≠stica arquitect√≥nica √∫nica."},
{"name": "Water Sports", "type": "Deportes de aventura", "rating": 4.3, "description": "Jet ski, paseos en banana y otras actividades de playa."},
{"name": "Local Markets", "type": "Mercado", "rating": 4.0, "description": "Mercados que venden mariscos frescos, productos locales y artesan√≠as."},
{"name": "Sunset Cruises", "type": "Tour en barco", "rating": 4.4, "description": "Paseos en barco en el r√≠o Kalu Ganga durante las horas del atardecer."},
{"name": "Garden Restaurants", "type": "Comida", "rating": 4.2, "description": "Restaurantes junto al r√≠o y en jardines que sirven mariscos frescos y cocina local."}
],
"Beruwala": [
{"name": "Beruwala Beach", "type": "Playa", "rating": 4.4, "description": "Larga playa dorada con aguas tranquilas, popular para nadar y vacaciones familiares."},
{"name": "Kande Viharaya", "type": "Templo budista", "rating": 4.5, "description": "Templo con gigantesca estatua de Buda de pie, sitio budista importante."},
{"name": "Barberyn Lighthouse", "type": "Faro", "rating": 4.3, "description": "Faro hist√≥rico en una peque√±a isla, accesible durante la marea baja."},
{"name": "Masjid-ul-Abrar", "type": "Mezquita", "rating": 4.2, "description": "Una de las mezquitas m√°s antiguas de Sri Lanka, construida por comerciantes √°rabes en el 920 d.C."},
{"name": "Water Sports Center", "type": "Deportes de aventura", "rating": 4.3, "description": "Diversas actividades acu√°ticas incluyendo jet ski, parasailing y paseos en barco."},
{"name": "Moragalla Beach", "type": "Playa", "rating": 4.4, "description": "Secci√≥n de playa menos concurrida con arena impecable y agua clara."},
{"name": "Traditional Fishing", "type": "Experiencia cultural", "rating": 4.2, "description": "Observe la pesca tradicional en zancos y t√©cnicas de pesca locales."},
{"name": "Spice Garden Tours", "type": "Jard√≠n", "rating": 4.1, "description": "Tours educativos de jardines de especias que muestran especias de Sri Lanka."},
{"name": "Beach Resorts", "type": "Alojamiento", "rating": 4.3, "description": "Gama de resorts frente a la playa con comodidades y vistas al oc√©ano."},
{"name": "Local Crafts", "type": "Compras", "rating": 4.0, "description": "Compre artesan√≠as tradicionales de Sri Lanka, batik y souvenirs."}
],
"Chilaw": [
{"name": "Munneswaram Temple", "type": "Templo hind√∫", "rating": 4.5, "description": "Importante complejo de templo hind√∫ dedicado al Se√±or Shiva, sitio de peregrinaci√≥n."},
{"name": "Chilaw Beach", "type": "Playa", "rating": 4.2, "description": "Playa de pesca con barcos coloridos, mariscos frescos y atm√≥sfera local."},
{"name": "St. Mary's Church", "type": "Iglesia", "rating": 4.1, "description": "Iglesia hist√≥rica con hermosa arquitectura y significado religioso."},
{"name": "Chilaw Fishing Harbor", "type": "Puerto", "rating": 4.0, "description": "Puerto de pesca activo donde se trae y subasta la captura diaria."},
{"name": "Anawilundawa Bird Sanctuary", "type": "Santuario de aves", "rating": 4.4, "description": "Sitio Ramsar de humedal con diversa vida aviar incluyendo especies migratorias."},
{"name": "Dutch Church", "type": "Iglesia", "rating": 4.0, "description": "Restos de iglesia colonial holandesa con significado hist√≥rico."},
{"name": "Crab Farming", "type": "Acuicultura", "rating": 4.2, "description": "Visite granjas de cangrejos para ver el cultivo y procesamiento de cangrejos de lodo."},
{"name": "Local Cuisine", "type": "Comida", "rating": 4.3, "description": "Restaurantes de mariscos frescos especializados en platos de cangrejo y pescado."},
{"name": "Traditional Industries", "type": "Experiencia cultural", "rating": 4.1, "description": "Vea industrias tradicionales como la fabricaci√≥n de cuerdas de coco y tejido de redes de pesca."},
{"name": "Paddy Fields", "type": "Paisaje agr√≠cola", "rating": 4.2, "description": "Vastos campos de arroz que rodean Chilaw, √°rea importante de cultivo de arroz."}
],
"Puttalam": [
{"name": "Puttalam Lagoon", "type": "Laguna", "rating": 4.3, "description": "Sistema extenso de lagunas con bosques de manglares y oportunidades de observaci√≥n de aves."},
{"name": "Kalpitiya Beach", "type": "Playa", "rating": 4.5, "description": "Larga playa de arena popular para kitesurf, windsurf y observaci√≥n de delfines."},
{"name": "Wilpattu National Park", "type": "Parque nacional", "rating": 4.6, "description": "Acceso al parque nacional m√°s grande de Sri Lanka desde el lado de Puttalam."},
{"name": "Dutch Canal", "type": "Canal", "rating": 4.1, "description": "Canal hist√≥rico construido por holandeses que conecta Puttalam con Colombo."},
{"name": "St. Anne's Church", "type": "Iglesia", "rating": 4.2, "description": "Iglesia hist√≥rica en Talawila, importante sitio de peregrinaci√≥n cat√≥lico."},
{"name": "Kitesurfing Centers", "type": "Deportes de aventura", "rating": 4.5, "description": "Escuelas profesionales de kitesurf y alquiler de equipo en Kalpitiya."},
{"name": "Dolphin Watching", "type": "Tour de vida silvestre", "rating": 4.4, "description": "Tours en barco para ver grandes manadas de delfines en las aguas de Kalpitiya."},
{"name": "Salt Pans", "type": "Industria", "rating": 4.1, "description": "Producci√≥n tradicional de sal usando estanques de evaporaci√≥n, industria local importante."},
{"name": "Mangrove Forests", "type": "Bosque", "rating": 4.2, "description": "Tours en barco a trav√©s de ecosistemas de manglares con flora y fauna diversa."},
{"name": "Fishing Villages", "type": "Experiencia cultural", "rating": 4.1, "description": "Visite comunidades de pesca tradicionales a lo largo de la costa de Puttalam."}
],
"Matara": [
{"name": "Star Fort", "type": "Fortaleza", "rating": 4.3, "description": "Fortaleza holandesa en forma de estrella √∫nica construida en 1765, ahora alberga un museo."},
{"name": "Matara Paravi Duwa Temple", "type": "Templo budista", "rating": 4.2, "description": "Templo en una peque√±a isla conectada por un puente, entorno pintoresco."},
{"name": "Polhena Beach", "type": "Playa", "rating": 4.4, "description": "Playa protegida con arrecife de coral, ideal para snorkel y nataci√≥n segura."},
{"name": "Weherahena Temple", "type": "Templo budista", "rating": 4.5, "description": "Templo √∫nico con t√∫nel que representa escenas budistas del infierno y el para√≠so."},
{"name": "Matara Beach", "type": "Playa", "rating": 4.3, "description": "√Årea principal de playa con paseo mar√≠timo, restaurantes y vistas al atardecer."},
{"name": "Dutch Reformed Church", "type": "Iglesia", "rating": 4.1, "description": "Iglesia holandesa hist√≥rica construida en 1706, a√∫n en uso hoy."},
{"name": "Nilwala River", "type": "R√≠o", "rating": 4.2, "description": "Paseos y paseos en barco en el principal r√≠o de Matara."},
{"name": "Local Markets", "type": "Mercado", "rating": 4.0, "description": "Mercados vibrantes que venden productos frescos, mariscos y bienes locales."},
{"name": "Historical Museum", "type": "Museo", "rating": 4.1, "description": "Museo que muestra la historia y patrimonio cultural de Matara."},
{"name": "Dondra Lighthouse", "type": "Faro", "rating": 4.2, "description": "Punto m√°s al sur de Sri Lanka con faro y vistas al oc√©ano."}
],
"Hambantota": [
{"name": "Yala National Park", "type": "Parque nacional", "rating": 4.7, "description": "Acceso al famoso Parque Nacional de Yala desde el lado de Hambantota."},
{"name": "Hambantota Port", "type": "Puerto", "rating": 4.1, "description": "Puerto de aguas profundas construido con asistencia china, maravilla de ingenier√≠a."},
{"name": "Mattala Rajapaksa International Airport", "type": "Aeropuerto", "rating": 4.0, "description": "Segundo aeropuerto internacional de Sri Lanka, arquitectura interesante."},
{"name": "Bundala National Park", "type": "Parque nacional", "rating": 4.4, "description": "Sitio Ramsar de humedal importante para aves migratorias y vida silvestre."},
{"name": "Hambantota Cricket Stadium", "type": "Instalaci√≥n deportiva", "rating": 4.2, "description": "Estadio de cricket internacional que alberga partidos mayores."},
{"name": "Bird Sanctuary", "type": "Santuario de aves", "rating": 4.3, "description": "√Årea importante para observaci√≥n de aves, especialmente especies de humedales."},
{"name": "Salt Pans", "type": "Industria", "rating": 4.1, "description": "Producci√≥n tradicional de sal usando evaporaci√≥n natural."},
{"name": "Local Fisheries", "type": "Industria", "rating": 4.0, "description": "Industria pesquera y mercados de mariscos frescos."},
{"name": "Development Projects", "type": "Infraestructura moderna", "rating": 4.1, "description": "Vea el desarrollo de infraestructura moderna en la regi√≥n de Hambantota."},
{"name": "Rural Villages", "type": "Experiencia cultural", "rating": 4.2, "description": "Vida aldeana tradicional en el sur de Sri Lanka."}
],
"Ampara": [
{"name": "Lahugala National Park", "type": "Parque nacional", "rating": 4.3, "description": "Santuario de elefantes con agujeros de agua naturales y vida silvestre."},
{"name": "Deegawapiya Temple", "type": "Templo budista", "rating": 4.4, "description": "Templo antiguo que se cree fue visitado por el Se√±or Buda."},
{"name": "Ampara Tank", "type": "Embalse", "rating": 4.1, "description": "Gran embalse de irrigaci√≥n que soporta la agricultura en la zona seca."},
{"name": "Gal Oya National Park", "type": "Parque nacional", "rating": 4.4, "description": "Safaris en barco para ver elefantes nadando entre islas."},
{"name": "Senanayake Samudraya", "type": "Embalse", "rating": 4.3, "description": "El embalse m√°s grande de Sri Lanka, esc√©nico e importante para irrigaci√≥n."},
{"name": "Ancient Buddhist Sites", "type": "Sitio arqueol√≥gico", "rating": 4.2, "description": "Varios monasterios budistas antiguos y ruinas en el distrito de Ampara."},
{"name": "Agriculture Farms", "type": "Granja", "rating": 4.1, "description": "Visite granjas que cultivan arroz, vegetales y frutas en la f√©rtil regi√≥n de Ampara."},
{"name": "Local Markets", "type": "Mercado", "rating": 4.0, "description": "Mercados que sirven a comunidades agr√≠colas en el este de Sri Lanka."},
{"name": "Traditional Crafts", "type": "Artesan√≠as", "rating": 4.1, "description": "Artesan√≠as locales incluyendo cer√°mica, tejido y trabajo en madera."},
{"name": "Cultural Diversity", "type": "Experiencia cultural", "rating": 4.2, "description": "Experimente una sociedad multicultural con comunidades sinhalesa, tamil y musulmana."}
],
"Monaragala": [
{"name": "Maligawila Buddha Statue", "type": "Estatua budista", "rating": 4.4, "description": "Antigua estatua de Buda de pie del siglo VII, de 11,5 m de altura."},
{"name": "Buddhangala Monastery", "type": "Monasterio budista", "rating": 4.3, "description": "Monasterio forestal antiguo con restos arqueol√≥gicos y oportunidades de meditaci√≥n."},
{"name": "Monaragala Town", "type": "Pueblo", "rating": 4.0, "description": "Pueblo principal que sirve a la regi√≥n sureste con mercados locales y servicios."},
{"name": "Agricultural Areas", "type": "Paisaje agr√≠cola", "rating": 4.1, "description": "Vastas tierras agr√≠colas que cultivan arroz, frutas y vegetales."},
{"name": "Traditional Villages", "type": "Experiencia cultural", "rating": 4.2, "description": "Visite pueblos tradicionales para ver la vida rural de Sri Lanka."},
{"name": "Natural Springs", "type": "Fuentes naturales", "rating": 4.1, "description": "Fuentes de agua dulce naturales usadas por comunidades locales."},
{"name": "Forest Areas", "type": "Bosque", "rating": 4.2, "description": "Bosques de zona seca con oportunidades de senderismo y vida silvestre."},
{"name": "Local Crafts", "type": "Artesan√≠as", "rating": 4.0, "description": "Artesan√≠as tradicionales incluyendo cer√°mica, tejido de cestas y tallado en madera."},
{"name": "Agricultural Markets", "type": "Mercado", "rating": 4.1, "description": "Mercados que venden productos agr√≠colas de la regi√≥n de Monaragala."},
{"name": "Rural Tourism", "type": "Experiencia cultural", "rating": 4.2, "description": "Iniciativas de turismo comunitario que muestran la cultura local."}
],
"Kurunegala": [
{"name": "Ethagala (Elephant Rock)", "type": "Formaci√≥n rocosa", "rating": 4.3, "description": "Gran formaci√≥n rocosa que se asemeja a un elefante, hito de Kurunegala."},
{"name": "Yapahuwa Rock Fortress", "type": "Sitio arqueol√≥gico", "rating": 4.5, "description": "Antigua fortaleza rocosa y palacio con impresionante escalinata y arquitectura."},
{"name": "Panduwasnuwara", "type": "Sitio arqueol√≥gico", "rating": 4.2, "description": "Antigua capital con ruinas, sitio de palacio y monumentos budistas."},
{"name": "Kurunegala Lake", "type": "Lago", "rating": 4.1, "description": "Lago artificial en el centro de la ciudad con senderos de paseo y jardines."},
{"name": "Ridi Viharaya", "type": "Templo budista", "rating": 4.4, "description": "Complejo de templo antiguo con dep√≥sitos de plata, hist√≥ricamente significativo."},
{"name": "Arankele Monastery", "type": "Monasterio budista", "rating": 4.3, "description": "Monasterio forestal con cuevas de meditaci√≥n y ruinas antiguas."},
{"name": "Local Markets", "type": "Mercado", "rating": 4.0, "description": "Mercados bulliciosos que sirven a la provincia noroeste con bienes diversos."},
{"name": "Agriculture", "type": "Paisaje agr√≠cola", "rating": 4.1, "description": "Visite granjas que cultivan arroz, coco y frutas en la regi√≥n f√©rtil."},
{"name": "Historical Sites", "type": "Sitio arqueol√≥gico", "rating": 4.2, "description": "Varios sitios hist√≥ricos que reflejan la importancia antigua de Kurunegala."},
{"name": "Temple Circuit", "type": "Tour religioso", "rating": 4.3, "description": "Tour de templos budistas importantes en y alrededor de Kurunegala."}
],
"Kegalle": [
{"name": "Pinnawala Elephant Orphanage", "type": "Centro de conservaci√≥n", "rating": 4.6, "description": "El reba√±o cautivo de elefantes m√°s grande del mundo, famoso por los ba√±os y horas de alimentaci√≥n de elefantes."},
{"name": "Elephant Bathing", "type": "Experiencia de vida silvestre", "rating": 4.7, "description": "Mire elefantes ba√±√°ndose en el r√≠o en horarios programados, oportunidad popular de foto."},
{"name": "Millennium Elephant Foundation", "type": "Centro de conservaci√≥n", "rating": 4.4, "description": "Organizaci√≥n de conservaci√≥n y bienestar de elefantes que ofrece programas educativos."},
{"name": "Kegalle Town", "type": "Pueblo", "rating": 4.0, "description": "Pueblo que sirve a la provincia central con mercados locales y servicios."},
{"name": "Spice Gardens", "type": "Jard√≠n", "rating": 4.2, "description": "Tours educativos de jardines de especias que muestran especias de Sri Lanka."},
{"name": "Traditional Industries", "type": "Experiencia cultural", "rating": 4.1, "description": "Vea industrias tradicionales como miner√≠a de gemas y agricultura."},
{"name": "Elephant Back Rides", "type": "Experiencia de vida silvestre", "rating": 4.3, "description": "Paseos √©ticos a lomo de elefante a trav√©s de √°reas designadas."},
{"name": "Local Markets", "type": "Mercado", "rating": 4.0, "description": "Mercados que venden productos locales, especias y artesan√≠as."},
{"name": "Rubber Plantations", "type": "Plantaci√≥n", "rating": 4.1, "description": "Visite plantaciones de caucho para ver la recolecci√≥n y procesamiento de l√°tex."},
{"name": "Scenic Countryside", "type": "Ruta esc√©nica", "rating": 4.2, "description": "Hermosos paseos en coche a trav√©s del campo ondulado de Kegalle y plantaciones."}
],
"Matale": [
{"name": "Aluvihara Rock Temple", "type": "Templo budista", "rating": 4.4, "description": "Templo en cueva antiguo donde las escrituras budistas se escribieron por primera vez en hojas de palma."},
{"name": "Matale Spice Gardens", "type": "Jard√≠n", "rating": 4.3, "description": "Tours educativos de jardines de especias en la capital de las especias de Sri Lanka."},
{"name": "Sri Muthumariamman Temple", "type": "Templo hind√∫", "rating": 4.2, "description": "Templo hind√∫ colorido con arquitectura impresionante y festivales."},
{"name": "Knuckles Mountain Range", "type": "Cadena monta√±osa", "rating": 4.6, "description": "Sitio Patrimonio de la Humanidad de la UNESCO con senderismo, cascadas y biodiversidad."},
{"name": "Riverston", "type": "Punto de vista", "rating": 4.5, "description": "Punto de vista espectacular en la cadena Knuckles con vistas panor√°micas de las monta√±as."},
{"name": "Matale Market", "type": "Mercado", "rating": 4.1, "description": "Famoso mercado de especias con amplia variedad de especias e hierbas frescas."},
{"name": "Ancient Temples", "type": "Templo budista", "rating": 4.2, "description": "Varios templos budistas antiguos en y alrededor de Matale."},
{"name": "Spice Processing", "type": "Industria", "rating": 4.2, "description": "Vea m√©todos tradicionales de procesamiento y empaquetado de especias."},
{"name": "Hiking Trails", "type": "Sendero de senderismo", "rating": 4.4, "description": "Varios senderos de senderismo en la cadena Knuckles para diferentes niveles de condici√≥n f√≠sica."},
{"name": "Cultural Diversity", "type": "Experiencia cultural", "rating": 4.1, "description": "Experimente una sociedad multicultural con comunidades budista, hind√∫ y musulmana."}
],
"Weligama": [
{"name": "Weligama Beach", "type": "Playa", "rating": 4.5, "description": "Larga playa de arena famosa por el surf, pescadores en zancos y observaci√≥n de ballenas."},
{"name": "Stilt Fishermen", "type": "Experiencia cultural", "rating": 4.4, "description": "M√©todo de pesca tradicional ic√≥nico √∫nico en el √°rea de Weligama."},
{"name": "Surfing Lessons", "type": "Lecciones de surf", "rating": 4.6, "description": "Escuelas de surf que ofrecen lecciones para principiantes en olas suaves."},
{"name": "Taprobane Island", "type": "Isla", "rating": 4.3, "description": "Isla privada con villa de lujo, accesible durante la marea baja."},
{"name": "Whale Watching", "type": "Tour de vida silvestre", "rating": 4.5, "description": "Tours en barco para ver ballenas azules y delfines desde el puerto de Weligama."},
{"name": "Polhena Beach", "type": "Playa", "rating": 4.4, "description": "Playa protegida con arrecife de coral, ideal para snorkel y nataci√≥n segura."},
{"name": "Local Markets", "type": "Mercado", "rating": 4.1, "description": "Mercados que venden mariscos frescos, productos locales y artesan√≠as."},
{"name": "Beachfront Restaurants", "type": "Comida", "rating": 4.3, "description": "Restaurantes que sirven mariscos frescos con vistas al oc√©ano."},
{"name": "Water Sports", "type": "Deportes de aventura", "rating": 4.2, "description": "Diversas actividades acu√°ticas incluyendo kayak y paddle boarding."},
{"name": "Sunset Views", "type": "Punto de vista", "rating": 4.5, "description": "Hermosos atardeceres sobre el Oc√©ano √çndico desde la playa de Weligama."}
]
}
      
        if city in fallback_places:
            places = fallback_places[city]
  
    # Almacenar en cach√© los resultados
    st.session_state.places_cache[cache_key] = places
    return places

# Funci√≥n para extraer la ciudad del t√≠tulo del d√≠a
def extract_city_from_title(title):
    """Extraer la ciudad principal del t√≠tulo del d√≠a"""
    title_lower = title.lower()
    city_mappings = {
        "colombo": "Colombo",
        "kandy": "Kandy",
        "nuwara eliya": "Nuwara Eliya",
        "nuwaraeliya": "Nuwara Eliya",
        "ella": "Ella",
        "yala": "Yala",
        "galle": "Galle",
        "sigiriya": "Sigiriya",
        "polonnaruwa": "Polonnaruwa",
        "anuradhapura": "Anuradhapura",
        "bentota": "Bentota",
        "mirissa": "Mirissa",
        "trincomalee": "Trincomalee",
        "trinco": "Trincomalee",
        "jaffna": "Jaffna",
        "dambulla": "Dambulla",
        "hikkaduwa": "Hikkaduwa",
        "arugam bay": "Arugam Bay",
        "arugambay": "Arugam Bay",
        "negombo": "Negombo",
        "batticaloa": "Batticaloa",
        "batti": "Batticaloa",
        "pasikudah": "Pasikudah",
        "weligama": "Weligama",
        "tangalle": "Tangalle",
        "badulla": "Badulla",
        "bandarawela": "Bandarawela",
        "hatton": "Hatton",
        "matara": "Matara",
        "hambantota": "Hambantota",
        "kalutara": "Kalutara",
        "beruwala": "Beruwala",
        "chilaw": "Chilaw",
        "puttalam": "Puttalam",
        "ratnapura": "Ratnapura",
        "kitulgala": "Kitulgala",
        "kegalle": "Kegalle",
        "kurunegala": "Kurunegala",
        "matale": "Matale",
        "monaragala": "Monaragala",
        "ampara": "Ampara",
        "vavuniya": "Vavuniya",
        "mannar": "Mannar",
        "udawalawe": "Udawalawe",
        "wilpattu": "Wilpattu"
    }
    for key, city in city_mappings.items():
        if key in title_lower:
            return city
    return None

# Funci√≥n para obtener lugares diarios
def get_daily_places(day_number, city, country, num_places=3):
    """Obtener lugares reales para un d√≠a espec√≠fico"""
    all_places = get_real_places(city, country, limit=20)
  
    if not all_places:
        return []
  
    # Seleccionar lugares diferentes para cada d√≠a
    start_idx = (day_number - 1) * num_places
    selected_places = []
  
    for i in range(num_places):
        idx = (start_idx + i) % len(all_places)
        place = all_places[idx].copy()
      
        # Agregar informaci√≥n adicional
        best_times = [
            "Ma√±ana 9AM-12PM (Mejor para fotos)",
            "Tarde 2PM-5PM (Evitar multitudes)",
            "Noche 6PM-9PM (Hermosas vistas al atardecer)"
        ]
      
        durations = ["2-3 horas", "3-4 horas", "1-2 horas"]
      
        # Mapear tipos de lugares a iconos
        icon_map = {
            "Buddhist Temple": "üõï", "Hindu Temple": "üõï", "Mosque": "üïå", "Church": "‚õ™",
            "Temple": "üõï", "Park": "üèûÔ∏è", "Museum": "üèõÔ∏è", "Historic": "üèõÔ∏è",
            "Market": "üõçÔ∏è", "Beach": "üèñÔ∏è", "Palace": "üè∞", "Castle": "üè∞",
            "Viewpoint": "üåÑ", "Garden": "üåø", "Lake": "üåä", "Statue": "üóΩ",
            "Fort": "üèØ", "Shopping": "üõí", "Cathedral": "‚õ™", "Shrine": "‚õ©Ô∏è",
            "Religious": "üïå", "Natural": "üå≤", "Architecture": "üè¢", "Attraction": "üìç",
            "Bridge": "üåâ", "Hiking Trail": "ü•æ", "Waterfall": "üåä", "Plantation": "üçµ",
            "Lagoon": "üèùÔ∏è", "Island": "üèùÔ∏è", "Lighthouse": "üóº", "Forest Reserve": "üå≥",
            "National Park": "üêò", "Wildlife Safari": "üêÖ", "Conservation Center": "üêò",
            "Archaeological Site": "üè∫", "Ancient Structure": "üèõÔ∏è", "Monument": "üóΩ",
            "Mountain": "‚õ∞Ô∏è", "River": "üåä", "Cave": "üï≥Ô∏è", "Hot Springs": "‚ô®Ô∏è",
            "Reservoir": "üíß", "Wetland": "üåø", "Bird Sanctuary": "ü¶Ö", "Marine Sanctuary": "üê†",
            "Adventure Sports": "üèÑ", "Surf Spot": "üèÑ", "Boat Tour": "üö§", "Cultural Show": "üé≠",
            "Workshop": "üî®", "Farm": "üöú", "Tea Factory": "üçµ", "Mine": "‚õèÔ∏è",
            "Golf Course": "‚õ≥", "Sports Venue": "üèüÔ∏è", "Airport": "‚úàÔ∏è", "Port": "üö¢",
            "Town": "üèôÔ∏è", "Village": "üè°", "Historical House": "üèöÔ∏è", "Film Location": "üé¨",
            "Camping": "üèïÔ∏è", "Scenic Route": "üõ£Ô∏è", "Modern Infrastructure": "üèóÔ∏è",
            "Accommodation": "üè®", "Dining": "üçΩÔ∏è", "Nightlife": "üç∏", "Shopping": "üõçÔ∏è",
            "Cultural Experience": "üéé", "Educational": "üìö", "Photography": "üì∑",
            "Pilgrimage Site": "üôè", "Religious Tour": "üõê", "Rural Tourism": "üåæ"
        }
      
        place.update({
            "best_time": best_times[i % len(best_times)],
            "duration": durations[i % len(durations)],
            "icon": icon_map.get(place['type'], "üìç"),
            "tags": [place['type'], "Popular", "Debe Visitar"]
        })
      
        selected_places.append(place)
  
    return selected_places

# Funci√≥n para generar itinerario completo usando IA
def generate_comprehensive_itinerary(email_content):
    """Generar itinerario de viaje completo usando IA"""
  
    # Extraer destino del email
    destination_prompt = f"""
    Extraer la siguiente informaci√≥n de esta consulta de viaje:
    {email_content}
  
    Devolver como JSON:
    {{
        "destination_country": "string",
        "destinations": ["string"],
        "duration_days": number,
        "travelers": number,
        "budget": "string",
        "interests": ["string"],
        "travel_dates": "string"
    }}
    """
  
    try:
        # Primero, extraer informaci√≥n del destino
        extraction_response = client.chat.completions.create(
            messages=[
                {"role": "system", "content": "Extraer informaci√≥n de viaje del correo electr√≥nico. Analizar destinos como una lista si se mencionan m√∫ltiples ciudades."},
                {"role": "user", "content": destination_prompt}
            ],
            model="llama-3.3-70b-versatile",
            temperature=0.1,
            max_tokens=500,
            response_format={"type": "json_object"}
        )
      
        extracted_info = json.loads(extraction_response.choices[0].message.content)
      
        country = extracted_info.get("destination_country", "")
        destinations = extracted_info.get("destinations", [])
        if not destinations:
            main_city = extracted_info.get("destination_city", "")
            if main_city:
                destinations = [main_city]
        days = extracted_info.get("duration_days", 5)
      
        # Obtener lugares reales para cada destino
        places_by_city = {}
        for dest_city in destinations:
            places_by_city[dest_city] = get_real_places(dest_city, country, limit=10)
      
        # Crear prompt de itinerario con lugares reales
        system_prompt = f"""Eres un planificador de viajes experto con conocimiento profundo de destinos globales.
      
        Crear un itinerario de viaje multi-ciudad detallado y realista para la ruta {', '.join(destinations)} en {country}.
      
        Lugares reales disponibles por ciudad:
        {json.dumps(places_by_city, indent=2)}
      
        Detalles del viaje:
        - Duraci√≥n: {days} d√≠as
        - Viajeros: {extracted_info.get('travelers', 2)}
        - Presupuesto: {extracted_info.get('budget', 'Medio')}
        - Intereses: {extracted_info.get('interests', ['General'])}
        - Fechas: {extracted_info.get('travel_dates', 'No especificado')}
      
        IMPORTANTE: Usar los lugares reales listados arriba, seleccionando de la lista de la ciudad apropiada para cada d√≠a. Incluir detalles espec√≠ficos como:
        - Horarios de apertura
        - Precios de entradas
        - Mejores momentos para visitar
        - Consejos de transporte
        - Recomendaciones de comida local
        - Perspectivas culturales
      
        Devolver SOLO JSON v√°lido con esta estructura:
        {{
            "trip_summary": {{
                "destination_country": "{country}",
                "destinations": {json.dumps(destinations)},
                "duration_days": {days},
                "travelers": {extracted_info.get('travelers', 2)},
                "budget": "{extracted_info.get('budget', 'Medio')}",
                "trip_title": "string",
                "trip_theme": "string",
                "best_time_to_visit": "string",
                "currency": "string",
                "language": "string",
                "time_zone": "string",
                "visa_requirements": "string",
                "vaccinations": "string",
                "safety_tips": "string",
                "packing_tips": "string"
            }},
            "daily_itinerary": [
                {{
                    "day": 1,
                    "title": "string (incluir nombre de ciudad)",
                    "overview": "string",
                    "morning": {{
                        "time": "9:00 AM - 12:00 PM",
                        "activity": "string (usar nombres de lugares reales)",
                        "description": "descripci√≥n detallada",
                        "duration": "3 horas",
                        "cost": "string",
                        "transportation": "string",
                        "tips": "string"
                    }},
                    "afternoon": {{...}},
                    "evening": {{...}},
                    "accommodation_suggestion": "string",
                    "food_recommendations": ["string"]
                }}
            ],
            "key_attractions": [
                {{
                    "name": "string (debe ser de la lista de lugares reales)",
                    "city": "string (la ciudad donde est√° esta atracci√≥n)",
                    "type": "string",
                    "description": "string",
                    "best_time_to_visit": "string",
                    "ticket_price": "string",
                    "opening_hours": "string",
                    "duration_needed": "string",
                    "transportation": "string",
                    "tips": "string"
                }}
            ],
            "local_cuisine": [
                {{
                    "dish": "string",
                    "description": "string",
                    "where_to_try": "string",
                    "approximate_cost": "string",
                    "vegetarian_option": "boolean"
                }}
            ],
            "transportation_guide": {{
                "airport_transfer": "string",
                "public_transportation": "string",
                "taxi_services": "string",
                "car_rental": "string",
                "walking_tours": "string",
                "transportation_tips": ["string"]
            }},
            "accommodation_recommendations": [
                {{
                    "type": "string (Presupuesto/Gama media/Lujo)",
                    "suggestions": ["string"],
                    "average_price": "string",
                    "best_locations": ["string"]
                }}
            ],
            "cultural_tips": [
                "string"
            ],
            "budget_breakdown": {{
                "accommodation": "string",
                "food": "string",
                "transportation": "string",
                "activities": "string",
                "souvenirs": "string",
                "miscellaneous": "string",
                "total_estimate": "string"
            }},
            "emergency_information": {{
                "emergency_number": "string",
                "police": "string",
                "ambulance": "string",
                "tourist_police": "string",
                "nearest_hospital": "string",
                "embassy_contact": "string"
            }},
            "seasonal_considerations": [
                "string"
            ]
        }}
      
        Hazlo pr√°ctico, detallado y basado en informaci√≥n tur√≠stica real."""
      
        response = client.chat.completions.create(
            messages=[
                {"role": "system", "content": system_prompt},
                {"role": "user", "content": f"Crear un itinerario completo para este viaje: {email_content}"}
            ],
            model="llama-3.3-70b-versatile",
            temperature=0.3,
            max_tokens=8000,
            response_format={"type": "json_object"}
        )
      
        result = response.choices[0].message.content.strip()
      
        # Limpiar JSON
        if result.startswith("```json"):
            result = result[7:-3]
        elif result.startswith("```"):
            result = result[3:-3]
      
        itinerary_data = json.loads(result)
      
        # Agregar datos de lugares reales al itinerario
        itinerary_data["places_by_city"] = places_by_city
      
        return itinerary_data
      
    except Exception as e:
        st.error(f"Error al generar itinerario: {str(e)}")
        return None

# Funci√≥n para crear visualizaci√≥n de mapa
def create_places_map(places, city, country):
    """Crear un mapa interactivo mostrando todos los lugares"""
    try:
        # Obtener coordenadas de la ciudad
        lat, lon = get_city_coordinates(city, country)
      
        # Crear mapa
        m = folium.Map(location=[lat, lon], zoom_start=12, tiles="CartoDB positron")
      
        # Agregar marcadores para cada lugar
        for place in places:
            if "coordinates" in place and place["coordinates"]["lat"] and place["coordinates"]["lon"]:
                popup_html = f"""
                <div style="width: 200px;">
                    <h4 style="margin: 5px 0; color: #3b82f6;">{place['name']}</h4>
                    <p style="margin: 5px 0; font-size: 12px; color: #666;">
                        <strong>Tipo:</strong> {place.get('type', 'Atracci√≥n')}<br>
                        <strong>Calificaci√≥n:</strong> {place.get('rating', 'N/A')}/5
                    </p>
                </div>
                """
              
                folium.Marker(
                    location=[place["coordinates"]["lat"], place["coordinates"]["lon"]],
                    popup=folium.Popup(popup_html, max_width=250),
                    tooltip=place["name"],
                    icon=folium.Icon(color="blue", icon="info-sign")
                ).add_to(m)
      
        return m
    except:
        return None

# Encabezado de la aplicaci√≥n con transparencia y vista de tarjeta
st.markdown("""
<div class="header-card">
    <div class="glow-effect"></div>
    <div class="header-content">
        <h1 class="gradient-text" style="font-size: 3.5rem; margin-bottom: 20px;">
             Asistente de Itinerario de Viaje IA
        </h1>
        <p class="header-subtitle">
            Crea itinerarios de viaje aut√©nticos para Sri Lanka con destinos reales, lugares verificados y planificaci√≥n potenciada por IA
        </p>
        <div class="header-icons">
            <span class="header-icon">ü§ñ Potenciado por IA</span>
            <span class="header-icon">üìç Lugares Reales</span>
            <span class="header-icon">üéØ Personalizado</span>
            <span class="header-icon">‚ö° Resultados Instant√°neos</span>
        </div>
    </div>
</div>
""", unsafe_allow_html=True)

# Barra lateral con caracter√≠sticas mejoradas
with st.sidebar:
    st.markdown("### üéØ Explorador de Sri Lanka")
  
    # Establecer pa√≠s predeterminado a Sri Lanka
    countries_data = get_all_countries()
    sri_lanka_data = next((c for c in countries_data if c["name"] == "Sri Lanka"), None)
  
    if sri_lanka_data:
        col_flag, col_info = st.columns([1, 3])
        with col_flag:
            st.markdown(f"<div style='font-size: 2.5rem;'>{sri_lanka_data['flag']}</div>", unsafe_allow_html=True)
        with col_info:
            st.markdown(f"""
            <div>
                <strong style="color: #1e293b;">{sri_lanka_data['name']}</strong><br>
                <span style="color: #475569; font-size: 0.9rem;">
                    üìç {sri_lanka_data['capital']}<br>
                    üë• {sri_lanka_data['population']:,}<br>
                    üåê {sri_lanka_data['region']}
                </span>
            </div>
            """, unsafe_allow_html=True)
  
    # Regiones de Sri Lanka
    st.markdown("### üó∫Ô∏è Regiones de Sri Lanka")
  
    regions = {
        "üèôÔ∏è Provincia Occidental": ["Colombo", "Negombo", "Kalutara"],
        "üèûÔ∏è Provincia Central": ["Kandy", "Nuwara Eliya", "Matale"],
        "üèñÔ∏è Provincia del Sur": ["Galle", "Matara", "Hambantota"],
        "‚òï Regi√≥n de las Colinas": ["Ella", "Badulla", "Bandarawela", "Hatton"],
        "üèõÔ∏è Tri√°ngulo Cultural": ["Sigiriya", "Dambulla", "Polonnaruwa", "Anuradhapura"],
        "üêò Vida Silvestre": ["Yala", "Udawalawe", "Wilpattu"],
        "üèÑ Aventura": ["Kitulgala", "Arugam Bay", "Weligama"],
        "üèùÔ∏è Para√≠so de Playas": ["Bentota", "Hikkaduwa", "Mirissa", "Tangalle", "Pasikudah"],
        "üåÖ Costa Este": ["Trincomalee", "Batticaloa"],
        "üå¥ Norte": ["Jaffna", "Mannar", "Vavuniya"]
    }
  
    selected_region = st.selectbox("Elegir Regi√≥n", list(regions.keys()))
  
    if selected_region:
        cities_in_region = regions[selected_region]
        selected_city = st.selectbox("Elegir Ciudad", cities_in_region)
      
        if st.button("üîç Explorar Ciudad", use_container_width=True):
            # Obtener lugares para esta ciudad
            with st.spinner(f"Buscando lugares en {selected_city}..."):
                places = get_real_places(selected_city, "Sri Lanka", limit=10)
              
                if places:
                    st.success(f"¬°Encontrados {len(places)} lugares en {selected_city}!")
                    for place in places[:3]:
                        st.markdown(f"""
                        <div style="background: #f8fafc; border-radius: 12px; padding: 12px; margin: 8px 0; border: 1px solid #e2e8f0;">
                            <strong style="color: #1e293b;">{place['name']}</strong>
                            <div style="color: #475569; font-size: 0.85rem;">{place['type']} ‚Ä¢ ‚≠ê {place.get('rating', 'N/A')}</div>
                        </div>
                        """, unsafe_allow_html=True)
  
    st.markdown("---")
  
    # Plantillas r√°pidas
    st.markdown("### üìã Plantillas de Itinerario Sri Lanka")
  
    template_options = {
        "üá±üá∞ Sri Lanka Cl√°sico 12 D√≠as": """Planificando un tour completo de 12 d√≠as de Sri Lanka.
Fechas de viaje: 15-26 de diciembre de 2024
Viajeros: 2 adultos
Presupuesto: $3500
Intereses: Cultura, historia, playas, vida silvestre, plantaciones de t√©
Destinos: Colombo, Sigiriya, Kandy, Nuwara Eliya, Ella, Yala, Galle, Bentota
Solicitudes espec√≠ficas:
- Visitar sitios del Patrimonio Mundial de la UNESCO
- Experimentar plantaciones de t√© y tour de f√°brica
- Hacer safari en el Parque Nacional de Yala
- Probar cocina aut√©ntica de Sri Lanka
- Tomar el tren esc√©nico de Kandy a Ella
- Incluir tiempo de playa en Bentota y Galle
- Visitar el Templo del Diente Sagrado
Alojamiento: Mezcla de hoteles 4 estrellas y propiedades boutique
Transporte: Coche privado con conductor para todo el viaje
Por favor crear un itinerario equilibrado con componentes culturales, naturales y de relajaci√≥n.""",
      
        "üèñÔ∏è Vacaciones en Playa Costa Sur 10 D√≠as": """Planificando vacaciones en playa de 10 d√≠as en el sur de Sri Lanka.
Fechas de viaje: 10-19 de enero de 2025
Viajeros: Familia de 4 (2 adultos, 2 ni√±os de 8 y 12 a√±os)
Presupuesto: $4000
Intereses: Playas, deportes acu√°ticos, actividades familiares, relajaci√≥n
Destinos: Colombo, Bentota, Hikkaduwa, Mirissa, Galle, Weligama
Solicitudes espec√≠ficas:
- Resorts playeros familiares con piscinas
- Actividades de deportes acu√°ticos (snorkeling, jet ski)
- Visitar el Fuerte de Galle y el criadero de tortugas
- Avistamiento de ballenas en Mirissa
- Playas seguras para nadar para ni√±os
- Actividades culturales adecuadas para ni√±os
- Opciones de entretenimiento nocturno
Alojamiento: Resorts frente a la playa con habitaciones familiares
Transporte: Minivan privado con conductor
Ritmo relajado con tiempo de playa y actividades familiares.""",
      
        "üåÑ Aventura en las Colinas 8 D√≠as": """Planificando una aventura de 8 d√≠as en la regi√≥n de las colinas.
Fechas de viaje: 15-22 de marzo de 2025
Viajeros: Pareja joven (viajeros activos)
Presupuesto: $2500
Intereses: Senderismo, plantaciones de t√©, cascadas, vistas panor√°micas, fotograf√≠a
Destinos: Kandy, Nuwara Eliya, Ella, Hatton, Bandarawela
Solicitudes espec√≠ficas:
- Senderismo a Little Adam's Peak y Ella Rock
- Visitar Horton Plains y World's End
- Tours de plantaciones de t√© y degustaci√≥n
- Viajes en tren esc√©nicos
- Visitas a cascadas (Ravana Falls, St. Clair's Falls)
- Oportunidades de fotograf√≠a
- Experiencias de pueblo local
Alojamiento: Hoteles boutique y casas de hu√©spedes
Transporte: Combinaci√≥n de tren y coche privado
Preferir itinerario activo con senderismo moderado.""",
      
        "üêò Vida Silvestre y Naturaleza 7 D√≠as": """Planificando un viaje de 7 d√≠as enfocado en vida silvestre.
Fechas de viaje: Febrero 2025
Viajeros: 2 entusiastas de la vida silvestre
Presupuesto: $3000
Intereses: Safaris de vida silvestre, observaci√≥n de aves, parques nacionales, conservaci√≥n
Destinos: Colombo, Yala, Udawalawe, Kitulgala, Sinharaja
Solicitudes espec√≠ficas:
- M√∫ltiples safaris de vida silvestre (ma√±ana y tarde)
- Tours de observaci√≥n de aves
- Visitar orfanato de elefantes y hogar de tr√°nsito
- Rafting en aguas bravas en Kitulgala
- Caminatas guiadas por la naturaleza
- Itinerario enfocado en fotograf√≠a
- Visitas a proyectos de conservaci√≥n
Alojamiento: Lodges de vida silvestre y eco-hoteles
Transporte: Jeeps safari 4x4 y coche privado
Querer oportunidades m√°ximas de observaci√≥n de vida silvestre."""
    }
  
    selected_template = st.selectbox("Elegir Plantilla", list(template_options.keys()))
  
    if st.button("üìù Usar Plantilla", use_container_width=True):
        st.session_state.email_text = template_options[selected_template]
  
    st.markdown("---")
  
    # Estad√≠sticas
    st.markdown("### üìä Estad√≠sticas de Sri Lanka")
  
    col_stat1, col_stat2 = st.columns(2)
    with col_stat1:
        st.markdown(f"""
        <div class="stat-card">
            <div class="stat-icon">üèôÔ∏è</div>
            <div class="stat-number">35</div>
            <div class="stat-label">Ciudades</div>
        </div>
        """, unsafe_allow_html=True)
  
    with col_stat2:
        st.markdown(f"""
        <div class="stat-card">
            <div class="stat-icon">üìç</div>
            <div class="stat-number">350+</div>
            <div class="stat-label">Atracciones</div>
        </div>
        """, unsafe_allow_html=True)
  
    st.markdown("---")
  
    # Configuraci√≥n
    st.markdown("### ‚öôÔ∏è Configuraci√≥n")
  
    show_images = st.checkbox("Mostrar Im√°genes", value=True)
    show_map = st.checkbox("Mostrar Mapa Interactivo", value=True)
    image_quality = st.select_slider("Calidad de Imagen", ["Baja", "Media", "Alta"], value="Media")
  
    if st.button("üîÑ Limpiar Cach√©", use_container_width=True):
        st.session_state.image_cache = {}
        st.session_state.places_cache = {}
        st.success("¬°Cach√© limpiado!")

# √Årea de contenido principal
col1, col2 = st.columns([2, 1])
with col1:
    st.markdown("### üìù Consulta de Viaje")
  
    email_text = st.text_area(
        "Describe tus planes de viaje a Sri Lanka en detalle:",
        value=st.session_state.email_text,
        height=280,
        placeholder="""üá±üá∞ ¬°Cu√©ntanos sobre tu viaje a Sri Lanka!
Ejemplo: Planificando un tour cultural y playero de 12 d√≠as de Sri Lanka.
Detalles esenciales:
- Fechas de viaje: 15-26 de diciembre de 2024
- Viajeros: 2 adultos
- Presupuesto: $3500 total
- Intereses: Cultura, historia, playas, vida silvestre, comida
- Destinos: Colombo, Sigiriya, Kandy, Nuwara Eliya, Ella, Yala, Galle
Solicitudes espec√≠ficas:
- Quiero ver sitios del Patrimonio Mundial de la UNESCO
- Interesado en tours de plantaciones de t√©
- Necesito opciones de comida vegetariana
- Prefiero hoteles 4 estrellas
- Quiero usar rutas de tren esc√©nicas
- Incluir safari de vida silvestre en Yala
- Tiempo de playa en Galle o Mirissa
¬°Cuantos m√°s detalles proporciones, mejor podremos personalizar tu itinerario!"""
    )
with col2:
    st.markdown("### ‚ú® Caracter√≠sticas de Sri Lanka")
  
    features = [
        ("üèõÔ∏è", "8 Sitios UNESCO", "Tri√°ngulo Cultural y Fuertes"),
        ("üèñÔ∏è", "1340km de Costa", "Hermosas playas"),
        ("üêò", "26 Parques Nacionales", "Vida Silvestre y Safari"),
        ("‚òï", "Pa√≠s del T√©", "Tours de estaciones de monta√±a"),
        ("üïå", "Multi-Cultural", "Budista, Hind√∫, Musulm√°n, Cristiano"),
        ("üå∂Ô∏è", "Jardines de Especias", "Cocina aut√©ntica"),
        ("üèÑ", "Deportes Acu√°ticos", "Surf, buceo, rafting"),
        ("üöÇ", "Trenes Esc√©nicos", "Ferrocarriles de monta√±a"),
        ("üåø", "Ayurveda", "Bienestar y Spa"),
        ("üì∑", "Fotograf√≠a", "Paisajes impresionantes")
    ]
  
    for icon, title, desc in features[:5]:
        st.markdown(f"""
        <div style="background: #f8fafc; border-radius: 12px; padding: 12px; margin-bottom: 10px; border-left: 3px solid #3b82f6; border: 1px solid #e2e8f0;">
            <div style="display: flex; align-items: center; gap: 10px;">
                <span style="font-size: 1.5rem;">{icon}</span>
                <div>
                    <strong style="color: #1e293b;">{title}</strong>
                    <p style="color: #475569; font-size: 0.8rem; margin: 3px 0 0 0;">{desc}</p>
                </div>
            </div>
        </div>
        """, unsafe_allow_html=True)

# Bot√≥n Generar
st.markdown("---")
col_btn1, col_btn2, col_btn3 = st.columns([3, 1, 1])
with col_btn1:
    generate_clicked = st.button(
        "üöÄ Generar Itinerario Sri Lanka",
        type="primary",
        use_container_width=True,
        help="Crear itinerario detallado con lugares e im√°genes reales"
    )
with col_btn2:
    if st.button("üé≤ Insp√≠rame", use_container_width=True):
        sri_lanka_cities = [
            "Colombo", "Kandy", "Galle", "Sigiriya", "Nuwara Eliya",
            "Ella", "Yala", "Mirissa", "Trincomalee", "Bentota"
        ]
        random_city = random.choice(sri_lanka_cities)
        days = random.randint(7, 14)
      
        st.session_state.email_text = f"""Planificando un viaje de {days} d√≠as para explorar la belleza de Sri Lanka, enfoc√°ndome en {random_city} y √°reas circundantes.
Fechas de viaje: Fechas flexibles el pr√≥ximo a√±o
Viajeros: {random.randint(1, 4)} {'persona' if random.randint(1, 4) == 1 else 'personas'}
Presupuesto: ${random.randint(2000, 5000)}
Intereses: Inmersi√≥n cultural, comida local, atracciones naturales, fotograf√≠a
Destinos: {random_city} y atracciones cercanas
Quiero experimentar: Cultura local aut√©ntica, atracciones imperdibles, joyas ocultas
Por favor crear un itinerario equilibrado que mezcle puntos tur√≠sticos populares con experiencias fuera de lo com√∫n."""
with col_btn3:
    if st.button("üîÑ Limpiar Todo", use_container_width=True):
        st.session_state.clear()
        st.rerun()

# Generar y mostrar itinerario
if generate_clicked and email_text.strip():
    with st.spinner("üá±üá∞ Creando tu itinerario completo de Sri Lanka con destinos reales..."):
        itinerary_data = generate_comprehensive_itinerary(email_text)
      
        if itinerary_data:
            st.session_state.itinerary = itinerary_data
            st.success("¬°Itinerario generado exitosamente!")
            time.sleep(1)
            st.rerun()

# Mostrar itinerario si est√° disponible
if st.session_state.itinerary:
    itinerary_data = st.session_state.itinerary
    summary = itinerary_data.get("trip_summary", {})
  
    country = summary.get("destination_country", "Sri Lanka")
    destinations = summary.get("destinations", [])
    city = destinations[0] if destinations else ""
    days = summary.get("duration_days", 0)
    travelers = summary.get("travelers", 2)
    budget = summary.get("budget", "")
    theme = summary.get("trip_theme", "")
  
    # Obtener bandera de Sri Lanka
    countries_data = get_all_countries()
    sri_lanka_data = next((c for c in countries_data if c["name"] == "Sri Lanka"), {})
    flag = sri_lanka_data.get("flag", "üá±üá∞") if sri_lanka_data else "üá±üá∞"
  
    # Encabezado de resumen del viaje
    st.markdown("---")
    st.markdown(f"""
    <div style="text-align: center; margin-bottom: 40px; padding: 30px; background: #f8fafc; border-radius: 25px; border: 1px solid #e2e8f0;">
        <div style="font-size: 4rem; margin-bottom: 10px;">{flag}</div>
        <h1 class="gradient-text" style="font-size: 2.8rem; margin-bottom: 15px;">
            {summary.get('trip_title', 'Tu Itinerario de Viaje a Sri Lanka')}
        </h1>
        <p style="color: #475569; font-size: 1.3rem; margin-bottom: 5px;">
            üìç {', '.join(destinations)} ‚Ä¢ ‚è±Ô∏è {days} D√≠as ‚Ä¢ üë• {travelers} Viajeros
        </p>
        <p style="color: #10b981; font-size: 1.1rem; font-weight: 600;">
            {theme} ‚Ä¢ üí∞ Presupuesto: {budget} ‚Ä¢ ‚≠ê {summary.get('best_time_to_visit', 'Mejor Temporada')}
        </p>
    </div>
    """, unsafe_allow_html=True)
  
    # Tarjetas de estad√≠sticas mejoradas
    col_stats = st.columns(5)
  
    stats_data = [
        ("üìç", "Destinos", ', '.join(destinations[:2]) + ('...' if len(destinations)>2 else '')),
        ("‚è±Ô∏è", "Duraci√≥n", f"{days} D√≠as"),
        ("üë•", "Viajeros", str(travelers)),
        ("üí∞", "Presupuesto", budget),
        ("‚≠ê", "Tema", theme[:15] + ('...' if len(theme) > 15 else ''))
    ]
  
    for idx, (icon, label, value) in enumerate(stats_data):
        with col_stats[idx]:
            st.markdown(f"""
            <div class="stat-card">
                <div class="stat-icon">{icon}</div>
                <div class="stat-number">{value}</div>
                <div class="stat-label">{label}</div>
            </div>
            """, unsafe_allow_html=True)
  
    # Tarjetas de informaci√≥n adicional
    if any([summary.get('currency'), summary.get('language'), summary.get('time_zone')]):
        st.markdown("### ‚ÑπÔ∏è Informaci√≥n del Destino")
      
        info_cols = st.columns(3)
      
        info_items = [
            ("üí±", "Moneda", summary.get('currency', 'Rupia de Sri Lanka (LKR)')),
            ("üó£Ô∏è", "Idioma", summary.get('language', 'Cingal√©s, Tamil, Ingl√©s')),
            ("üïê", "Zona Horaria", summary.get('time_zone', 'GMT+5:30'))
        ]
      
        for idx, (icon, label, value) in enumerate(info_items):
            with info_cols[idx]:
                st.markdown(f"""
                <div style="background: #f8fafc; border-radius: 15px; padding: 20px; text-align: center; border: 1px solid #e2e8f0;">
                    <div style="font-size: 2rem; margin-bottom: 10px;">{icon}</div>
                    <div style="color: #1e293b; font-weight: 600; margin-bottom: 5px;">{label}</div>
                    <div style="color: #475569; font-size: 0.9rem;">{value}</div>
                </div>
                """, unsafe_allow_html=True)
  
    # Mapa interactivo (para la ciudad principal)
    if show_map:
        real_places = itinerary_data.get("places_by_city", {}).get(city, [])
        if real_places:
            st.markdown('<div class="section-title">üó∫Ô∏è Mapa Interactivo</div>', unsafe_allow_html=True)
          
            map_obj = create_places_map(real_places, city, country)
            if map_obj:
                with st.container():
                    folium_static(map_obj, width=1200, height=500)
  
    # Atracciones clave
    key_attractions = itinerary_data.get("key_attractions", [])
    if key_attractions:
        st.markdown('<div class="section-title">üåü Atracciones Imperdibles</div>', unsafe_allow_html=True)
      
        # Vista superior: Disposici√≥n horizontal usando columnas para tarjetas lado a lado
        num_cols = min(3, len(key_attractions)) # Hasta 3 columnas para vista superior
        attraction_cols = st.columns(num_cols)
      
        for idx, attraction in enumerate(key_attractions):
            with attraction_cols[idx % num_cols]:
                # Obtener imagen real de la atracci√≥n usando su ciudad
                att_city = attraction.get("city", city)
                image_data = get_place_image(attraction["name"], att_city, country, size="medium") if show_images else None
              
                # Tarjeta de lugar sin HTML crudo para evitar problemas de renderizado
                st.markdown(f"### {attraction['name']}")
                st.markdown(f"**Tipo:** {attraction.get('type', 'Atracci√≥n')}")
                st.markdown(f"**Mejor Momento:** {attraction.get('best_time_to_visit', 'N/A')}")
                st.markdown(f"**Duraci√≥n:** {attraction.get('duration_needed', 'N/A')}")
              
                if image_data:
                    st.image(image_data["url"], caption=f"üì∏ {image_data['photographer']}", use_container_width=True)
              
                st.markdown(f"**Descripci√≥n:** {attraction.get('description', '')}")
              
                # Cuadr√≠cula de informaci√≥n usando columnas para simular la cuadr√≠cula sin HTML
                info_col1, info_col2 = st.columns(2)
                with info_col1:
                    st.markdown(f"**üé´ Precio de Entrada:** {attraction.get('ticket_price', 'Variable')}")
                    st.markdown(f"**üïê Horarios de Apertura:** {attraction.get('opening_hours', 'N/A')}")
                with info_col2:
                    st.markdown(f"**üöó Transporte:** {attraction.get('transportation', 'N/A')}")
                    st.markdown(f"**üí° Consejos:** {attraction.get('tips', 'N/A')}")
              
                st.markdown("---") # Separador para cada atracci√≥n
  
    # Secci√≥n Itinerario Diario
    st.markdown('<div class="section-title">üìÖ Itinerario Diario</div>', unsafe_allow_html=True)
  
    daily_itinerary = itinerary_data.get("daily_itinerary", [])
  
    for day in daily_itinerary:
        day_num = day.get("day", 1)
        day_title = day.get("title", "Explorando")
        day_overview = day.get("overview", "")
      
        # Extraer ciudad para este d√≠a
        current_city = extract_city_from_title(day_title)
        if not current_city:
            current_city = city # respaldo a la ciudad principal
      
        # Encabezado del D√≠a
        st.markdown(f"""
        <div class="day-header">
            <h2 style="color: white; margin: 0; font-size: 1.8rem;">D√≠a {day_num}: {day_title}</h2>
            {f'<p style="color: rgba(255, 255, 255, 0.8); margin: 10px 0 0 0; font-size: 1rem;">{day_overview}</p>' if day_overview else ''}
        </div>
        """, unsafe_allow_html=True)
      
        # Obtener lugares REALES para este d√≠a usando la ciudad actual
        daily_places = get_daily_places(day_num, current_city, country, num_places=3)
      
        # Mostrar Lugares
        if daily_places:
            st.markdown("### üèÜ Mejores Atracciones para Hoy")
          
            place_cols = st.columns(min(3, len(daily_places)))
          
            for idx, place in enumerate(daily_places):
                with place_cols[idx]:
                    with st.container():
                        # Obtener imagen
                        image_data = None
                        if show_images:
                            with st.spinner(""):
                                image_data = get_place_image(place["name"], current_city, country, size="medium")
                      
                        # Contenido de la tarjeta
                        col_badge, col_rating = st.columns([2, 1])
                        with col_badge:
                            st.markdown(f"""<div class="place-badge">{place['type']}</div>""", unsafe_allow_html=True)
                      
                        with col_rating:
                            stars = "‚≠ê" * int(place.get("rating", 4))
                            if place.get("rating", 4) - int(place.get("rating", 4)) >= 0.5:
                                stars += "¬Ω"
                          
                            st.markdown(f"""
                            <div style="display: flex; align-items: center; gap: 5px;">
                                <span style="color: #f59e0b; font-size: 0.9rem;">{stars}</span>
                                <span style="color: #f59e0b; font-weight: bold; font-size: 0.9rem;">
                                    {place.get('rating', 4)}/5
                                </span>
                            </div>
                            """, unsafe_allow_html=True)
                      
                        # Nombre del lugar
                        st.markdown(f"""
                        <div style="color: #1e293b; font-size: 1.2rem; font-weight: 700; margin: 10px 0;">
                            {place['icon']} {place['name']}
                        </div>
                        """, unsafe_allow_html=True)
                      
                        # Imagen
                        if image_data and show_images:
                            try:
                                st.image(
                                    image_data["url"],
                                    caption=f"üì∏ {image_data['photographer']}",
                                    use_container_width=True
                                )
                            except:
                                pass
                      
                        # Descripci√≥n
                        st.markdown(f"""
                        <div style="color: #475569; font-size: 0.9rem; line-height: 1.6; margin: 10px 0;">
                            {place['description']}
                        </div>
                        """, unsafe_allow_html=True)
                      
                        # Etiquetas
                        if "tags" in place:
                            tag_cols = st.columns(3)
                            for tag_idx, tag in enumerate(place["tags"][:3]):
                                with tag_cols[tag_idx]:
                                    st.markdown(f"""<div class="place-tag">{tag}</div>""", unsafe_allow_html=True)
                      
                        # Informaci√≥n de tiempo
                        col_time1, col_time2 = st.columns(2)
                        with col_time1:
                            st.markdown(f"""
                            <div class="time-item">
                                <span style="color: #60a5fa;">‚è∞</span>
                                <span>{place['best_time']}</span>
                            </div>
                            """, unsafe_allow_html=True)
                      
                        with col_time2:
                            st.markdown(f"""
                            <div class="time-item">
                                <span style="color: #10b981;">üïê</span>
                                <span>{place['duration']}</span>
                            </div>
                            """, unsafe_allow_html=True)
      
        # Horario diario
        st.markdown("### ‚è∞ Horario Diario")
      
        schedule_data = [
            ("üåÖ Ma√±ana", "morning", day.get("morning", {})),
            ("‚òÄÔ∏è Tarde", "afternoon", day.get("afternoon", {})),
            ("üåô Noche", "evening", day.get("evening", {}))
        ]
      
        schedule_cols = st.columns(3)
      
        for idx, (title, key, schedule) in enumerate(schedule_data):
            with schedule_cols[idx]:
                if schedule:
                    card_class = f"{key}-card"
                  
                    st.markdown(f"""
                    <div class="schedule-card {card_class}">
                        <h4 style="color: {['#f59e0b', '#10b981', '#8b5cf6'][idx]}; margin: 0 0 15px 0; font-size: 1.2rem;">
                            {title}
                        </h4>
                        <p style="color: #475569; font-size: 0.9rem; margin: 5px 0;">
                            <strong>{schedule.get('time', 'N/A')}</strong>
                        </p>
                        <p style="color: #1e293b; font-weight: 600; margin: 10px 0; font-size: 1.1rem;">
                            {schedule.get('activity', '')}
                        </p>
                        <p style="color: #475569; font-size: 0.9rem; line-height: 1.6;">
                            {schedule.get('description', '')}
                        </p>
                    </div>
                    """, unsafe_allow_html=True)
                  
                    # Informaci√≥n adicional
                    info_items = [
                        ("üí∞ Costo", schedule.get('cost')),
                        ("üöó Transporte", schedule.get('transportation')),
                        ("üí° Consejos", schedule.get('tips'))
                    ]
                  
                    for info_label, info_value in info_items:
                        if info_value:
                            st.info(f"**{info_label}:** {info_value}")
      
        # Alojamiento y Comida
        col_acc, col_food = st.columns(2)
      
        with col_acc:
            if day.get("accommodation_suggestion"):
                st.markdown(f"""
                <div style="background: rgba(59, 130, 246, 0.1); border-radius: 15px; padding: 20px; margin-top: 20px;">
                    <h4 style="color: #3b82f6; margin: 0 0 10px 0;">üè® Alojamiento</h4>
                    <p style="color: #475569; margin: 0;">{day['accommodation_suggestion']}</p>
                </div>
                """, unsafe_allow_html=True)
      
        with col_food:
            if day.get("food_recommendations"):
                st.markdown(f"""
                <div style="background: rgba(245, 158, 11, 0.1); border-radius: 15px; padding: 20px; margin-top: 20px;">
                    <h4 style="color: #f59e0b; margin: 0 0 10px 0;">üçΩÔ∏è Recomendaciones Gastron√≥micas</h4>
                    <ul style="color: #475569; margin: 0; padding-left: 20px;">
                        {"".join([f'<li style="margin-bottom: 5px;">{item}</li>' for item in day["food_recommendations"][:3]])}
                    </ul>
                </div>
                """, unsafe_allow_html=True)
      
        st.markdown("---")
  
    # Desglose de presupuesto (Visual)
    budget_data = itinerary_data.get("budget_breakdown", {})
    if budget_data and budget_data.get("total_estimate"):
        st.markdown('<div class="section-title">üí∞ Desglose del Presupuesto</div>', unsafe_allow_html=True)
      
        # Crear gr√°fico circular
        budget_items = []
        budget_values = []
      
        for key, value in budget_data.items():
            if key != "total_estimate" and value:
                budget_items.append(key.title())
                budget_values.append(float(value.replace('$', '').replace(',', '')) if '$' in str(value) else 100)
      
        if budget_items and budget_values:
            fig = go.Figure(data=[go.Pie(
                labels=budget_items,
                values=budget_values,
                hole=.3,
                marker_colors=['#3b82f6', '#10b981', '#f59e0b', '#8b5cf6', '#ec4899', '#6b7280']
            )])
          
            fig.update_layout(
                title="Distribuci√≥n del Presupuesto",
                showlegend=True,
                height=400,
                paper_bgcolor='rgba(0,0,0,0)',
                plot_bgcolor='rgba(0,0,0,0)',
                font=dict(color='#475569')
            )
          
            st.plotly_chart(fig, use_container_width=True)
          
            st.markdown(f"""
            <div style="text-align: center; margin-top: 20px;">
                <h3 style="color: #10b981;">Presupuesto Total Estimado: {budget_data.get('total_estimate', 'N/A')}</h3>
            </div>
            """, unsafe_allow_html=True)
  
    # Informaci√≥n de emergencia
    emergency_info = itinerary_data.get("emergency_information", {})
    if emergency_info:
        st.markdown('<div class="section-title">‚öïÔ∏è Informaci√≥n de Emergencia</div>', unsafe_allow_html=True)
      
        em_cols = st.columns(2)
      
        with em_cols[0]:
            st.warning(f"""
            **Contactos de emergencia en Sri Lanka:**
            - üö® Emergencia: {emergency_info.get('emergency_number', '119 / 118')}
            - üëÆ Polic√≠a: {emergency_info.get('police', '119')}
            - üöë Ambulancia: {emergency_info.get('ambulance', '110')}
            - üõ°Ô∏è Polic√≠a Tur√≠stica: {emergency_info.get('tourist_police', '1912')}
            """)
      
        with em_cols[1]:
            st.error(f"""
            **Informaci√≥n importante:**
            - üè• Hospital m√°s cercano: {emergency_info.get('nearest_hospital', 'Verificar localmente')}
            - üèõÔ∏è Contacto de Embajada: {emergency_info.get('embassy_contact', 'Contacte a su embajada en Colombo')}
            - ‚ö†Ô∏è Consejos de seguridad: {summary.get('safety_tips', 'Mantenerse alerta en √°reas concurridas')}
            """)
  
    # Secci√≥n Descarga
    st.markdown('<div class="section-title">üì• Opciones de Exportaci√≥n</div>', unsafe_allow_html=True)
  
    col_dl1, col_dl2, col_dl3, col_dl4 = st.columns(4)
  
    with col_dl1:
        # Descarga JSON
        json_data = json.dumps(itinerary_data, indent=2, ensure_ascii=False)
        st.download_button(
            label="üìä Datos Completos (JSON)",
            data=json_data,
            file_name=f"itinerario_sri_lanka.json",
            mime="application/json",
            use_container_width=True
        )
  
    with col_dl2:
        # Descarga de texto tipo PDF
        daily_itinerary = itinerary_data.get("daily_itinerary", [])
        key_attractions = itinerary_data.get("key_attractions", [])
        text_content = f"""
{'='*70}
üá±üá∞ ITINERARIO DE VIAJE COMPLETO A SRI LANKA
{'='*70}
Destino: {', '.join(destinations)}
Duraci√≥n: {days} d√≠as
Viajeros: {travelers}
Presupuesto: {budget}
Tema: {theme}
{'='*70}
RESUMEN DEL VIAJE
{'='*70}
‚Ä¢ Mejor √©poca para visitar: {summary.get('best_time_to_visit', 'Diciembre a abril para Oeste/Sur, mayo a septiembre para Este')}
‚Ä¢ Moneda: {summary.get('currency', 'Rupia de Sri Lanka (LKR)')}
‚Ä¢ Idioma: {summary.get('language', 'Cingal√©s, Tamil, Ingl√©s')}
‚Ä¢ Zona horaria: {summary.get('time_zone', 'GMT+5:30')}
‚Ä¢ Requisitos de visa: {summary.get('visa_requirements', 'ETA requerido para la mayor√≠a de nacionalidades')}
‚Ä¢ Vacunas: {summary.get('vaccinations', 'Consultar m√©dico, recomendado: Hepatitis A, Tifoidea')}
‚Ä¢ Consejos de equipaje: {summary.get('packing_tips', 'Ropa de algod√≥n ligera, protecci√≥n solar, repelente de mosquitos, ropa modesta para templos')}
{'='*70}
ITINERARIO DIARIO
{'='*70}
"""
        for day in daily_itinerary:
            text_content += f"""
D√≠a {day.get('day')}: {day.get('title')}
{'-'*50}
Ma√±ana ({day.get('morning', {}).get('time', 'N/A')}):
Actividad: {day.get('morning', {}).get('activity', 'N/A')}
Descripci√≥n: {day.get('morning', {}).get('description', 'N/A')}
Costo: {day.get('morning', {}).get('cost', 'N/A')}
Tarde ({day.get('afternoon', {}).get('time', 'N/A')}):
Actividad: {day.get('afternoon', {}).get('activity', 'N/A')}
Descripci√≥n: {day.get('afternoon', {}).get('description', 'N/A')}
Costo: {day.get('afternoon', {}).get('cost', 'N/A')}
Noche ({day.get('evening', {}).get('time', 'N/A')}):
Actividad: {day.get('evening', {}).get('activity', 'N/A')}
Descripci√≥n: {day.get('evening', {}).get('description', 'N/A')}
Costo: {day.get('evening', {}).get('cost', 'N/A')}
Alojamiento: {day.get('accommodation_suggestion', 'N/A')}
Recomendaciones gastron√≥micas: {', '.join(day.get('food_recommendations', []))}
"""
      
        text_content += f"""
{'='*70}
ATRACCIONES CLAVE
{'='*70}
"""
        for attraction in key_attractions[:5]:
            text_content += f"""
‚Ä¢ {attraction['name']} ({attraction.get('type', 'Atracci√≥n')}) en {attraction.get('city', 'N/A')}
  Descripci√≥n: {attraction.get('description', 'N/A')}
  Mejor momento: {attraction.get('best_time_to_visit', 'N/A')}
  Entrada: {attraction.get('ticket_price', 'N/A')}
  Horarios: {attraction.get('opening_hours', 'N/A')}
  Consejos: {attraction.get('tips', 'N/A')}
"""
      
        st.download_button(
            label="üìù Gu√≠a Detallada (TXT)",
            data=text_content,
            file_name="guia_viaje_sri_lanka.txt",
            mime="text/plain",
            use_container_width=True
        )
  
    with col_dl3:
        # Descarga CSV
        csv_data = []
        daily_itinerary = itinerary_data.get("daily_itinerary", [])
        for day in daily_itinerary:
            day_num = day.get("day", 1)
            day_city = extract_city_from_title(day.get("title", "")) or city
            daily_places = get_daily_places(day_num, day_city, country)
            for place in daily_places:
                csv_data.append({
                    "D√≠a": day_num,
                    "Lugar": place["name"],
                    "Tipo": place["type"],
                    "Calificaci√≥n": place.get("rating", ""),
                    "Mejor Momento": place["best_time"],
                    "Duraci√≥n": place["duration"],
                    "Descripci√≥n": place["description"][:150]
                })
      
        if csv_data:
            df = pd.DataFrame(csv_data)
            csv_string = df.to_csv(index=False)
            st.download_button(
                label="üìà Datos de Lugares (CSV)",
                data=csv_string,
                file_name="lugares_sri_lanka.csv",
                mime="text/csv",
                use_container_width=True
            )
  
    with col_dl4:
        if st.button("üîÑ Nuevo Itinerario", use_container_width=True):
            st.session_state.itinerary = None
            st.session_state.email_text = ""
            st.rerun()

# Pie de p√°gina
st.markdown("---")
st.markdown("""
<div style="text-align: center; color: #64748b; padding: 30px; margin-top: 40px;">
    <div style="display: flex; justify-content: center; gap: 25px; margin-bottom: 20px; flex-wrap: wrap;">
        <div style="display: flex; align-items: center; gap: 8px; background: #f8fafc; padding: 10px 20px; border-radius: 25px; border: 1px solid #e2e8f0;">
            <span style="color: #60a5fa;">üèôÔ∏è</span>
            <span>35 Ciudades de Sri Lanka</span>
        </div>
        <div style="display: flex; align-items: center; gap: 8px; background: #f8fafc; padding: 10px 20px; border-radius: 25px; border: 1px solid #e2e8f0;">
            <span style="color: #60a5fa;">üìç</span>
            <span>350+ Atracciones</span>
        </div>
        <div style="display: flex; align-items: center; gap: 8px; background: #f8fafc; padding: 10px 20px; border-radius: 25px; border: 1px solid #e2e8f0;">
            <span style="color: #60a5fa;">ü§ñ</span>
            <span>Itinerarios Potenciados por IA</span>
        </div>
        <div style="display: flex; align-items: center; gap: 8px; background: #f8fafc; padding: 10px 20px; border-radius: 25px; border: 1px solid #e2e8f0;">
            <span style="color: #60a5fa;">üîÑ</span>
            <span>Actualizaciones en Tiempo Real</span>
        </div>
    </div>
    <p style="margin: 10px 0; font-size: 0.9rem; color: #475569;">
        Potenciado por: <strong>REST Countries ‚Ä¢ OpenTripMap ‚Ä¢ Foursquare ‚Ä¢ Unsplash ‚Ä¢ Pexels ‚Ä¢ Groq AI</strong>
    </p>
    <p style="margin: 0; font-size: 0.8rem; color: #64748b;">
        ¬© 2024 Asistente de Itinerario de Viaje IA Sri Lanka ‚Ä¢ La Perla del Oc√©ano √çndico ‚Ä¢ Todos los datos verificados y organizados
    </p>
</div>
""", unsafe_allow_html=True)